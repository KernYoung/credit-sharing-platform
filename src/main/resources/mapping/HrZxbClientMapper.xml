<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fanruan.platform.mapper.HrZxbClientMapper" >
  <resultMap id="BaseResultMap" type="com.fanruan.platform.bean.HrZxbClient" >
    <id column="FID" property="fId" jdbcType="VARCHAR" />
    <result column="CODE" property="code" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="CLIENTNO" property="clientNo" jdbcType="VARCHAR" />
    <result column="UPDATEBY" property="updateBy" jdbcType="VARCHAR" />
    <result column="UPDATETIME" property="updateTime" jdbcType="VARCHAR" />
    <result column="COMPANY_TYPE" property="companyType" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    rownum r,FID, CODE, NAME, CLIENTNO, UPDATEBY, UPDATETIME, COMPANY_TYPE
  </sql>
  <update id="updateByPrimaryKeySelective" parameterType="com.fanruan.platform.bean.HrZxbClient" >

        update INPUT_HR_ZXB_CLIENT
        <set >
             CLIENTNO = #{clientNo,jdbcType=VARCHAR},
        </set>
    where code = #{code,jdbcType=VARCHAR}
  </update>

  <select id="listByMap" resultMap="BaseResultMap" parameterType="java.util.Map" >
select * from
   ( select rownum r,c.* from (SELECT CODE code,G.COMPANYCODE companyCode,G.COMPANYNAME companyName,name,'HR系统' AS company_type
  FROM ODS_HR_ORG O
  LEFT JOIN DIM_ORG G ON O.CODE=G.SUBCOMPANYCODE

   UNION
  SELECT CODE code,
     '' AS companyCode,
     '' AS  companyName,
     name,
     '手工填报' AS company_type
  FROM INPUT_HR_ORG
   ORDER BY COMPANYCODE,CODE) c
    where 1=1
      <if test="code != null" >
          and code = #{code,jdbcType=VARCHAR}
      </if>
      <if test="name != null" >
          and name = #{name,jdbcType=VARCHAR}
      </if>
     and rownum &lt;= #{pageIndex} * #{pageSize}
    ) where  r &gt;= (#{pageIndex}-1) * #{pageSize}
  </select>
</mapper>