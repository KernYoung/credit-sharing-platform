<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fanruan.platform.mapper.CommonsMapper">

<!--    <resultMap id="getBlackListResultMap" type="com.fanruan.platform.bean.BlackList">-->
<!--        <result column="PID" jdbcType="VARCHAR" property="pid" />-->
<!--        <result column="ENTNAME" jdbcType="VARCHAR" property="entName" />-->
<!--        <result column="CODE" jdbcType="VARCHAR" property="code" />-->
<!--        <result column="START_DATE" jdbcType="TIMESTAMP" property="startDate" />-->
<!--        <result column="END_DATE" jdbcType="TIMESTAMP" property="endDate" />-->
<!--        <result column="GRADE" jdbcType="VARCHAR" property="grade" />-->
<!--        <result column="REASON" jdbcType="VARCHAR" property="reason" />-->
<!--        <result column="REASON_URL" jdbcType="VARCHAR" property="reasonUrl" />-->
<!--        <result column="PUBLISH_DEPT" jdbcType="VARCHAR" property="publishDept" />-->
<!--        <result column="APPROVE_DEPT" jdbcType="VARCHAR" property="approveDept" />-->
<!--        <result column="PUBLISH_TIME" jdbcType="TIMESTAMP" property="publishTime" />-->
<!--        <result column="TYPE" jdbcType="VARCHAR" property="type" />-->
<!--        <result column="STATUS" jdbcType="VARCHAR" property="status" />-->
<!--        <result column="APPROVE_TIME" jdbcType="TIMESTAMP" property="approveTime" />-->
<!--        <result column="UPDATEBY" jdbcType="VARCHAR" property="updateby" />-->
<!--        <result column="CANCEL_BY" jdbcType="VARCHAR" property="cancelBy" />-->
<!--        <result column="CANCEL_TIME" jdbcType="VARCHAR" property="cancelTime" />-->
<!--        <result column="CANCEL_REASON" jdbcType="VARCHAR" property="cancelReason" />-->
<!--    </resultMap>-->
<!--    <select id="getBlackList" resultType="com.fanruan.platform.bean.BlackList">-->
<!--        select-->
<!--        PID-->
<!--        , ENTNAME-->
<!--        , CODE-->
<!--        , START_DATE-->
<!--        , GRADE-->
<!--        , REASON-->
<!--        , REASON_URL-->
<!--        , TYPE-->
<!--        , STATUS-->
<!--        , PUBLISH_DEPTID-->
<!--        , PUBLISH_DEPT-->
<!--        , PUBLISH_SDEPTID-->
<!--        , PUBLISH_SDEPT-->
<!--        , PUBLISH_BY-->
<!--        , PUBLISH_TIME-->
<!--        , APPROVE_BY-->
<!--        , APPROVE_TIME-->
<!--        , APPROVE_REMARKS-->
<!--        , CANCEL_BY-->
<!--        , CANCEL_TIME-->
<!--        , CANCEL_REASON-->
<!--        , FILENAME-->
<!--        , UPDATEBY-->
<!--        , UPDATETIME-->
<!--        , END_DATE-->
<!--        , APPROVE_DEPT-->
<!--        , COMPANYNAME-->
<!--        , REASONS_FOR_RENEWAL-->
<!--        from INPUT_BLACKLIST  where sysdate &lt;= add_months(start_date,1) and status=2-->
<!--        and COMPANYNAME in (-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;二级公司-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  A.CODE=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP=2-->
<!--        UNION-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;管理员-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  'admin'=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP IN (1,2)-->
<!--        UNION-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;集团-->
<!--        FROM DIM_ORG O-->
<!--        WHERE  '浙江省国际贸易集团有限公司' =-->
<!--        (-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;集团-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  A.CODE=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP=1-->
<!--        )-->
<!--        AND O.TP IN (1,2)-->
<!--        UNION-->
<!--        SELECT a.NAME FROM(-->
<!--        SELECT * FROM biuser.ODS_HR_ORG a start  with a.NAME  = (-->
<!--        SELECT ORGNAME-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        WHERE  A.CODE=#{userCode}&#45;&#45;用户名-->
<!--        )  connect  by-->
<!--        prior  a.SCODE  = a.CODE) a-->
<!--        WHERE SCODE = '010' OR CODE = '010'-->
<!--        )-->
<!--        UNION ALL-->
<!--        select-->
<!--        rawtohex(SYS_GUID()) AS PID,-->
<!--        a.NAME,-->
<!--        a.credit_code,-->
<!--        a.DATE1,-->
<!--        a.GRADE,-->
<!--        a.REASON,-->
<!--        a.REASON_URL,-->
<!--        a.TYPE,-->
<!--        a.STATUS,-->
<!--        a.PUBLISH_DEPTID,-->
<!--        a.PUBLISH_DEPT,-->
<!--        a.PUBLISH_SDEPTID,-->
<!--        a.PUBLISH_SDEPT,-->
<!--        a.FIELD0002,-->
<!--        a.date2,-->
<!--        a.APPROVE_BY,-->
<!--        a.APPROVE_TIME,-->
<!--        a.APPROVE_REMARKS,-->
<!--        a.CANCEL_BY,-->
<!--        a.CANCEL_TIME,-->
<!--        a.CANCEL_REASON,-->
<!--        a.FILENAME,-->
<!--        a.UPDATEBY,-->
<!--        a.UPDATEtIME,-->
<!--        a.END_DATE,-->
<!--        a.E_DEPT,-->
<!--        a.field0001,-->
<!--        a.REASONS_FOR_RENEWAL-->

<!--        from(-->
<!--        select-->
<!--        distinct-->
<!--        NAME,-->
<!--        t.credit_code,-->
<!--        to_date(a.field0032,'yyyy-mm-dd') AS DATE1,-->
<!--        '' AS GRADE,-->
<!--        '' AS REASON,-->
<!--        '' AS REASON_URL,-->
<!--        '' AS TYPE,-->
<!--        '' AS STATUS,-->
<!--        '' AS PUBLISH_DEPTID,-->
<!--        '' AS PUBLISH_DEPT,-->
<!--        '' AS PUBLISH_SDEPTID,-->
<!--        '' AS PUBLISH_SDEPT,-->
<!--        A.FIELD0002,-->
<!--        TO_DATE(A.field0032,'yyyy-mm-dd') AS date2,-->
<!--        '' AS APPROVE_BY,-->
<!--        SYSDATE AS APPROVE_TIME,-->
<!--        '' AS APPROVE_REMARKS,-->
<!--        '' AS CANCEL_BY,-->
<!--        SYSDATE AS CANCEL_TIME,-->
<!--        '' AS CANCEL_REASON,-->
<!--        '' AS FILENAME,-->
<!--        '' AS UPDATEBY,-->
<!--        SYSDATE AS UPDATEtIME,-->
<!--        SYSDATE AS END_DATE,-->
<!--        '' AS  E_DEPT,-->
<!--        a.field0001,-->
<!--        '' AS REASONS_FOR_RENEWAL-->
<!--        from  BIUSER.TEMP_INPUT_BLACKLIST t-->
<!--        join ODS_OA_RISKASSET  a  on a.field0021 = t.name-->
<!--        left join DIM_OA_RISKENUM b on a.field0017 = b.enum_id_k and b.enum_name_k = '科目大类' and enum_id_d = '0'-->
<!--        left join DIM_OA_RISKENUM c on a.field0006 = c.enum_id_k and c.enum_name_k = '风险资产状态'-->
<!--        left join DIM_OA_RISKENUM d on a.field0019 = d.enum_id_k and d.enum_name_k = '业务大类'-->
<!--        ) a-->
<!--    </select>-->
<!--    <select id="getBlackList" resultType="com.fanruan.platform.bean.BlackList">-->

<!--        select * from INPUT_BLACKLIST  where sysdate &lt;=add_months(start_date,1) and status=2-->
<!--        and COMPANYNAME in (-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;二级公司-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  A.CODE=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP=2-->
<!--        UNION-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;管理员-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  'admin'=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP IN (1,2)-->
<!--        UNION-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;集团-->
<!--        FROM DIM_ORG O-->
<!--        WHERE  '浙江省国际贸易集团有限公司' =-->
<!--        (-->
<!--        SELECT DISTINCT O.SUBCOMPANYNAME &#45;&#45;集团-->
<!--        FROM ODS_HR_PSNDOC A-->
<!--        LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE-->
<!--        WHERE  A.CODE=#{userCode}&#45;&#45;用户名-->
<!--        AND O.TP=1-->
<!--        )-->
<!--        AND O.TP IN (1,2)-->
<!--        )-->
<!--    </select>-->

    <resultMap id="getUserCompanyResultMap" type="com.fanruan.platform.bean.UserCompany">
        <result column="CODE" jdbcType="VARCHAR" property="code" />
        <result column="NAME" jdbcType="VARCHAR" property="name" />
    </resultMap>

    <select id="getUserCompany" resultType="com.fanruan.platform.bean.UserCompany">
        with ds1 as(
            SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.ODS_HR_ORG
            UNION
            SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.INPUT_HR_ORG
            WHERE ENABLESTATE=1
        )
        SELECT CODE,NAME --自身
        FROM ds1 A
        WHERE  CODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{username})
        UNION ALL
        SELECT CODE,NAME --下级公司
        FROM ds1 A
        WHERE SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{username})
        UNION ALL
        SELECT B.CODE,B.NAME --下下级公司
        FROM ds1 A
                 INNER JOIN ds1 B ON A.CODE=B.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{username})
        UNION ALL
        SELECT C.CODE,C.NAME --下下下级公司
        FROM ds1 A
                 INNER JOIN ds1 B ON A.CODE=B.SCODE
                 INNER JOIN ds1 C ON B.CODE=C.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{username})
        UNION ALL
        SELECT D.CODE,D.NAME --下下下下级公司
        FROM ds1 A
                 INNER JOIN ds1 B ON A.CODE=B.SCODE
                 INNER JOIN ds1 C ON B.CODE=C.SCODE
                 INNER JOIN ds1 D ON C.CODE=D.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{username})
        order by code
    </select>

<!--    <resultMap id="reportbuyerNoIsExist4ApplyResultMap" type="com.fanruan.platform.bean.ZhongXinBaoLog">-->
<!--        <result column="corpSerialNo" jdbcType="VARCHAR" property="corpSerialNo" />-->
<!--        <result column="clientNo" jdbcType="VARCHAR" property="clientNo" />-->
<!--        <result column="reportbuyerNo" jdbcType="VARCHAR" property="reportbuyerNo" />-->
<!--        <result column="reportCorpCountryCode" jdbcType="VARCHAR" property="reportCorpCountryCode" />-->
<!--        <result column="reportCorpChnName" jdbcType="VARCHAR" property="reportCorpChnName" />-->
<!--        <result column="reportCorpEngName" jdbcType="VARCHAR" property="reportCorpEngName" />-->
<!--        <result column="reportCorpaddress" jdbcType="VARCHAR" property="reportCorpaddress" />-->
<!--        <result column="creditno" jdbcType="VARCHAR" property="creditno" />-->
<!--        <result column="istranslation" jdbcType="VARCHAR" property="istranslation" />-->
<!--        <result column="corpSerialNoOut" jdbcType="VARCHAR" property="corpSerialNoOut" />-->
<!--        <result column="approveCode" jdbcType="VARCHAR" property="approveCode" />-->
<!--        <result column="approveMsg" jdbcType="VARCHAR" property="approveMsg" />-->
<!--        <result column="clientNoOut" jdbcType="VARCHAR" property="clientNoOut" />-->
<!--        <result column="otherMsg" jdbcType="VARCHAR" property="otherMsg" />-->
<!--        <result column="updateBy" jdbcType="VARCHAR" property="updateBy" />-->
<!--        <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />-->
<!--        <result column="approveby" jdbcType="VARCHAR" property="approveby" />-->
<!--        <result column="approveDate" jdbcType="TIMESTAMP" property="approveDate" />-->
<!--        <result column="updateName" jdbcType="VARCHAR" property="updateName" />-->
<!--        <result column="approveName" jdbcType="VARCHAR" property="approveName" />-->
<!--    </resultMap>-->

    <select id="reportbuyerNoIsExist4Apply" resultType="com.fanruan.platform.bean.ZhongXinBaoLog">

        SELECT * FROM (
                          SELECT CORPSERIALNO_IMPORT AS corpSerialNo,APPROVECODE,UPDATETIME FROM LOG_ZXB_APPLY
                          WHERE REPORTBUYERNO = #{reportbuyerNo}
                          ORDER BY UPDATETIME DESC)
        WHERE ROWNUM = 1
    </select>

    <resultMap id="getZxbApplyListResultMap" type="com.fanruan.platform.bean.ZhongXinBaoLog">
        <result column="corpSerialNo" jdbcType="VARCHAR" property="corpSerialNo" />
        <result column="clientNo" jdbcType="VARCHAR" property="clientNo" />
        <result column="reportbuyerNo" jdbcType="VARCHAR" property="reportbuyerNo" />
        <result column="reportCorpCountryCode" jdbcType="VARCHAR" property="reportCorpCountryCode" />
        <result column="reportCorpChnName" jdbcType="VARCHAR" property="reportCorpChnName" />
        <result column="reportCorpEngName" jdbcType="VARCHAR" property="reportCorpEngName" />
        <result column="reportCorpaddress" jdbcType="VARCHAR" property="reportCorpaddress" />
        <result column="creditno" jdbcType="VARCHAR" property="creditno" />
        <result column="istranslation" jdbcType="VARCHAR" property="istranslation" />
        <result column="corpSerialNoOut" jdbcType="VARCHAR" property="corpSerialNoOut" />
        <result column="approveCode" jdbcType="VARCHAR" property="approveCode" />
        <result column="approveMsg" jdbcType="VARCHAR" property="approveMsg" />
        <result column="clientNoOut" jdbcType="VARCHAR" property="clientNoOut" />
        <result column="otherMsg" jdbcType="VARCHAR" property="otherMsg" />
        <result column="updateBy" jdbcType="VARCHAR" property="updateBy" />
        <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
        <result column="approveby" jdbcType="VARCHAR" property="approveby" />
        <result column="approveDate" jdbcType="TIMESTAMP" property="approveDate" />
        <result column="updateName" jdbcType="VARCHAR" property="updateName" />
        <result column="approveName" jdbcType="VARCHAR" property="approveName" />
    </resultMap>

    <select id="getZxbApplyList" resultType="com.fanruan.platform.bean.ZhongXinBaoLog">
        with ds1 as(
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.ODS_HR_ORG
        UNION
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.INPUT_HR_ORG
        )
        SELECT
        M.CORPSERIALNO_IMPORT as corpSerialNo,
        M.CLIENTNO_IMPORT as clientNo,
        M.REPORTBUYERNO as reportbuyerNo,
        M.REPORTCORPCOUNTRYCODE as reportCorpCountryCode,
        M.REPORTCORPCHNNAME as reportCorpChnName,
        M.REPORTCORPENGNAME as reportCorpEngName,
        M.REPORTCORPADDRESS as reportCorpaddress,
        M.CREDITNO as creditno,
        M.ISTRANSLATION as istranslation,
        M.CORPSERIALNO_EXPORT as corpSerialNoOut,
        M.APPROVECODE as approveCode,
        M.APPROVEMSG as approveMsg,
        M.CLIENTNO_EXPORT as clientNoOut,
        M.OTHERMSG as otherMsg,
        M.UPDATEBY as updateBy,
        M.UPDATETIME as updateTime,
        M.APPROVEBY as approveby,
        M.APPROVEDATE as approveDate,
        M.updateName as updateName,
        M.approveName as approveName,
        M.SPEED as speed
        FROM (SELECT ROWNUM AS rowno, N.*
        FROM (SELECT T.*,
        U.NAME as updateName,
        P.NAME as approveName
        FROM LOG_ZXB_APPLY T
        LEFT JOIN CREDIT_USER U ON T.UPDATEBY = U.USERNAME
        LEFT JOIN CREDIT_USER P ON T.APPROVEBY = P.USERNAME
        WHERE 1 = 1
        AND U.COMPANY_CODE IN (
        SELECT CODE --自身
        FROM ds1 A
        WHERE  CODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT CODE --下级公司
        FROM ds1 A
        WHERE SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT B.CODE --下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT C.CODE --下下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        INNER JOIN ds1 C ON B.CODE=C.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT D.CODE --下下下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        INNER JOIN ds1 C ON B.CODE=C.SCODE
        INNER JOIN ds1 D ON C.CODE=D.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        )
        ORDER BY updateTime DESC) N
        WHERE 1 = 1
        <if test="zxbCode != null and zxbCode!=''">
            and (N.reportbuyerNo like '%'||#{zxbCode}||'%' )
        </if>
        <if test="zxbCompanyName != null and zxbCompanyName!='' ">
            and (N.reportCorpChnName like '%'||#{zxbCompanyName}||'%' OR N.reportCorpEngName like '%'||#{zxbCompanyName}||'%' )
        </if>
        <if test="approveCode != null and approveCode != ''">
            and (N.approveCode = #{approveCode})
        </if>
        <if test="zxbInformant != null and zxbInformant!=''">
            and (updateName like '%'||#{zxbInformant}||'%' )
        </if>
        <if test="zxbApprover != null and zxbApprover!=''">
            and (approveName like '%'||#{zxbApprover}||'%' )
        </if>
        ) M
        WHERE 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getZxbApplyListCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

    <select id="getZxbApplyListCount" resultType="java.lang.Integer">
        with ds1 as(
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.ODS_HR_ORG
        UNION
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.INPUT_HR_ORG
        )
        select COUNT(1) from (
        SELECT
        M.CORPSERIALNO_IMPORT as corpSerialNo,
        M.CLIENTNO_IMPORT as clientNo,
        M.REPORTBUYERNO as reportbuyerNo,
        M.REPORTCORPCOUNTRYCODE as reportCorpCountryCode,
        M.REPORTCORPCHNNAME as reportCorpChnName,
        M.REPORTCORPENGNAME as reportCorpEngName,
        M.REPORTCORPADDRESS as reportCorpaddress,
        M.CREDITNO as creditno,
        M.ISTRANSLATION as istranslation,
        M.CORPSERIALNO_EXPORT as corpSerialNoOut,
        M.APPROVECODE as approveCode,
        M.APPROVEMSG as approveMsg,
        M.CLIENTNO_EXPORT as clientNoOut,
        M.OTHERMSG as otherMsg,
        M.UPDATEBY as updateBy,
        M.UPDATETIME as updateTime,
        M.APPROVEBY as approveby,
        M.APPROVEDATE as approveDate,
        M.updateName as updateName,
        M.approveName as approveName
        FROM (SELECT ROWNUM AS rowno, N.*
        FROM (SELECT T.*,
        U.NAME as updateName,
        P.NAME as approveName
        FROM LOG_ZXB_APPLY T
        LEFT JOIN CREDIT_USER U ON T.UPDATEBY = U.USERNAME
        LEFT JOIN CREDIT_USER P ON T.APPROVEBY = P.USERNAME
        WHERE 1 = 1
        AND U.COMPANY_CODE IN (
        SELECT CODE --自身
        FROM ds1 A
        WHERE  CODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT CODE --下级公司
        FROM ds1 A
        WHERE SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT B.CODE --下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT C.CODE --下下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        INNER JOIN ds1 C ON B.CODE=C.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        UNION ALL
        SELECT D.CODE --下下下下级公司
        FROM ds1 A
        INNER JOIN ds1 B ON A.CODE=B.SCODE
        INNER JOIN ds1 C ON B.CODE=C.SCODE
        INNER JOIN ds1 D ON C.CODE=D.SCODE
        WHERE A.SCODE=(SELECT COMPANY_CODE FROM CREDIT_USER WHERE USERNAME=#{operator})
        )
        ORDER BY updateTime DESC) N
        WHERE 1 = 1
        <if test="zxbCode != null and zxbCode!=''">
            and (N.reportbuyerNo like '%'||#{zxbCode}||'%' )
        </if>
        <if test="zxbCompanyName != null and zxbCompanyName!='' ">
            and (N.reportCorpChnName like '%'||#{zxbCompanyName}||'%' OR N.reportCorpEngName like '%'||#{zxbCompanyName}||'%' )
        </if>
        <if test="approveCode != null and approveCode != ''">
            and (N.approveCode = #{approveCode})
        </if>
        <if test="zxbInformant != null and zxbInformant!=''">
            and (updateName like '%'||#{zxbInformant}||'%' )
        </if>
        <if test="zxbApprover != null and zxbApprover!=''">
            and (approveName like '%'||#{zxbApprover}||'%' )
        </if>
        ) M
        WHERE 1 = 1
        )
    </select>

    <insert id="insertOAMsg" parameterType="java.util.List">
        insert into INPUT_PUSH(ID,USER_NAME,PUSH_FLAG,PUSH_TIME,PROMPTINFO,PUSH_TYPE) VALUES(lower(sys_guid())
                                                                                            ,#{updateBy}--填报人
                                                                                            ,'0'
                                                                                            ,SYSDATE
                                                                                            ,'您的信保报告申请已被'||#{approveBy}||'驳回，请重新申请。'--审核人
                                                                                            ,'信保报告审核')
    </insert>

    <update id="updateTYCJson" parameterType="com.fanruan.platform.bean.TianYanChaJson">

        UPDATE ODS_TYC_JSON SET UPDATETIME = SYSDATE, ERROR_CODE = #{errorCode}, REASON = #{reason}, JSON = #{json}
        WHERE ID = #{id,jdbcType=VARCHAR} AND NAME = #{name} AND JSONFLAG = #{jsonFlag}
    </update>

    <update id="updateTYCJsonByIdBlank" parameterType="com.fanruan.platform.bean.TianYanChaJson">

        UPDATE ODS_TYC_JSON SET UPDATETIME = SYSDATE, ERROR_CODE = #{errorCode}, REASON = #{reason}, JSON = #{json}
        WHERE ID is null AND NAME = #{name} AND JSONFLAG = #{jsonFlag}
    </update>

    <insert id="insertTYCJson" parameterType="com.fanruan.platform.bean.TianYanChaJson">
        INSERT INTO ODS_TYC_JSON
         (ERROR_CODE, REASON,JSON, UPDATETIME, NAME, ID, JSONFLAG, TOKEN_ID, PARAM_IN, INSERT_DATE)
        VALUES

        <if test="json != null and json !=''">
            ( #{errorCode}, #{reason}, #{json}, TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS'), #{name}, #{id,jdbcType=VARCHAR}, #{jsonFlag}, #{tokenId}, #{paramIn}, TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS'))
        </if>

        <if test="json == null or json ==''">
            ( #{errorCode}, #{reason}, #{json}, TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD'),'YYYY-MM-DD'), #{name}, #{id,jdbcType=VARCHAR}, #{jsonFlag}, #{tokenId}, #{paramIn}, TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS'))
        </if>



    </insert>

    <resultMap id="getAllCompanyLevelResultMap" type="com.fanruan.platform.bean.CompanyLevel">
        <result column="code" jdbcType="VARCHAR" property="code" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="scode" jdbcType="VARCHAR" property="scode" />
    </resultMap>
    <select id="getAllCompanyLevel" resultType="com.fanruan.platform.bean.CompanyLevel">
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.ODS_HR_ORG
        where ENABLESTATE='2'
        <if test="companyCode != null and companyCode !=''">
            and (SCODE = #{companyCode})
        </if>
        UNION
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.INPUT_HR_ORG
        WHERE ENABLESTATE='1'
        <if test="companyCode != null and companyCode !=''">
           and (SCODE = #{companyCode})
        </if>
    </select>

    <resultMap id="getCompanyLevelResultMap" type="com.fanruan.platform.bean.CompanyLevel">
        <result column="code" jdbcType="VARCHAR" property="code" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="scode" jdbcType="VARCHAR" property="scode" />
    </resultMap>
    <select id="getCompanyLevel" resultType="com.fanruan.platform.bean.CompanyLevel">
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.ODS_HR_ORG
        where ENABLESTATE='2'
        <if test="companyCode != null and companyCode !=''">
            and (CODE = #{companyCode})
        </if>
        UNION
        SELECT CODE,NAME,SCODE,SNAME FROM BIUSER.INPUT_HR_ORG
        WHERE ENABLESTATE='1'
        <if test="companyCode != null and companyCode !=''">
            and (CODE = #{companyCode})
        </if>
    </select>


    <resultMap id="getCompanyStatusResultMap" type="java.lang.String">
        <result column="flag" jdbcType="VARCHAR" property="flag" />
    </resultMap>
    <select id="getCompanyStatus" resultType="java.lang.String">
        SELECT CASE WHEN ENABLESTATE='2' THEN '1' ELSE '0' END AS FLAG FROM BIUSER.ODS_HR_ORG
        WHERE 1 = 1
        <if test="companyCode != null and companyCode !=''">
        and (CODE = #{companyCode})
        </if>
        UNION
        SELECT CASE WHEN ENABLESTATE='1' THEN '1' ELSE '0' END AS FLAG FROM BIUSER.INPUT_HR_ORG
        WHERE 1 = 1
        <if test="companyCode != null and companyCode !=''">
            and (CODE = #{companyCode})
        </if>
    </select>

    <resultMap id="getAllUpdataByResultMap" type="java.lang.String">
        <result column="UPDATEBY" jdbcType="VARCHAR" property="UPDATEBY" />
    </resultMap>
    <select id="getAllUpdataBy" resultType="java.lang.String">
        select DISTINCT UPDATEBY FROM INPUT_CUSTOM_HAND
    </select>

    <resultMap id="getAllSerialidResultMap" type="java.lang.String">
        <result column="SERIALID" jdbcType="VARCHAR" property="SERIALID" />
    </resultMap>
    <select id="getAllSerialid" resultType="java.lang.String">
        SELECT DISTINCT SERIALID from INPUT_CUSTOM_HAND where SERIALID like  #{updataBy}||'%'  order by to_number(REGEXP_SUBSTR(SERIALID,'[0-9]+')) desc
    </select>

    <resultMap id="getMerchantsViewResultsCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

<!--    <select id="getMerchantsViewResultsCount" resultType="java.lang.Integer">-->
<!--        SELECT COUNT(*) FROM(-->
<!--        SELECT ROWNUM AS rowno, Y.* FROM(-->
<!--        SELECT Row_number()over(partition by X.CUSTOM_NAME order by X.UPDATETIME desc) rn, X.* FROM(-->
<!--        WITH ds1 as(-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        UNION-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        and b.NAME IS NOT NULL-->
<!--        UNION-->
<!--        SELECT '' AS DATE1-->
<!--        ,a.CUSTOM_SOCIAL_CODE-->
<!--        ,a.CUSTOM_NAME-->
<!--        ,'' AS "ID"-->
<!--        ,b.REASON AS "NAME"-->
<!--        ,'' AS COMPANYORGTYPE-->
<!--        ,'' AS REGCAPITAL-->
<!--        ,'' AS ESTIBLISHTIME-->
<!--        ,'' AS REGLOCATION-->
<!--        ,'' AS INDUSTRY-->
<!--        ,'' AS DS_CREDITCODE-->
<!--        ,'' AS GS_CREDITCODE-->
<!--        ,'' AS REGT_CREDIDTCODE-->
<!--        ,'' AS REG_CREDIDTCODE-->
<!--        ,'' AS FROMTIME-->
<!--        ,'' AS TOTIME-->
<!--        ,'' AS UPDATETIME-->
<!--        ,'' AS CREDIT_CODE-->
<!--        ,'' AS LEGALPERSONNAME-->
<!--        ,'' AS BASE-->
<!--        ,'' AS INVESTORNAME-->
<!--        ,'' AS ETL_FLAG-->
<!--        ,'' AS CREATETIME-->
<!--        ,0 AS TIMES-->
<!--        ,'' AS INPUT_NAME-->
<!--        ,'' AS BUSINESS_SCOPE-->
<!--        ,'' AS PHONE_NUMBER-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_JSON b-->
<!--        on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        b.error_code > '0'-->
<!--        AND b.JSONFLAG = '1001'-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        )-->
<!--        SELECT M.* FROM (-->
<!--        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a-->
<!--        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME-->
<!--        where 1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        )M-->
<!--        )X-->
<!--        )Y WHERE RN = 1)-->
<!--    </select>-->

    <select id="getMerchantsViewResultsCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM(
        SELECT ROWNUM AS rowno, Y.* FROM(
        SELECT Row_number()over(partition by X.CUSTOM_NAME order by X.UPDATETIME desc) rn, X.* FROM(
        WITH ds1 as(
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        UNION
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        and b.NAME IS NOT NULL
        UNION
        SELECT '' AS DATE1
        ,a.CUSTOM_SOCIAL_CODE
        ,a.CUSTOM_NAME
        ,'' AS "ID"
        ,b.REASON AS "NAME"
        ,'' AS COMPANYORGTYPE
        ,'' AS REGCAPITAL
        ,'' AS ESTIBLISHTIME
        ,'' AS REGLOCATION
        ,'' AS INDUSTRY
        ,'' AS DS_CREDITCODE
        ,'' AS GS_CREDITCODE
        ,'' AS REGT_CREDIDTCODE
        ,'' AS REG_CREDIDTCODE
        ,'' AS FROMTIME
        ,'' AS TOTIME
        ,'' AS UPDATETIME
        ,'' AS CREDIT_CODE
        ,'' AS LEGALPERSONNAME
        ,'' AS BASE
        ,'' AS INVESTORNAME
        ,'' AS ETL_FLAG
        ,'' AS CREATETIME
        ,0 AS TIMES
        ,'' AS INPUT_NAME
        ,'' AS BUSINESS_SCOPE
        ,'' AS PHONE_NUMBER
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join (select id,name,jsonflag,max(updatetime),max(reason) as reason,max(error_code) as error_code from ODS_TYC_JSON  group by  id,name,jsonflag) b
        on a.CUSTOM_NAME = b.NAME
        where
        b.error_code > '0'
        AND b.JSONFLAG = '1001'
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        )
        SELECT M.* FROM (
        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a
        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME
        where 1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        )M
        )X
        )Y WHERE RN = 1)
    </select>

    <resultMap id="getMerchantsViewResultsResultMap" type="com.fanruan.platform.bean.MerchantsViewResults">
        <result column="customName1" jdbcType="VARCHAR" property="customName1"/>
        <result column="customSocialCode" jdbcType="VARCHAR" property="customSocialCode"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="companyorgtype" jdbcType="VARCHAR" property="companyorgtype"/>
        <result column="industry" jdbcType="VARCHAR" property="industry"/>
        <result column="reglocation" jdbcType="VARCHAR" property="reglocation"/>
        <result column="businessScope" jdbcType="VARCHAR" property="businessScope"/>
        <result column="phoneNumber" jdbcType="VARCHAR" property="phoneNumber"/>
        <result column="regcapital" jdbcType="VARCHAR" property="regcapital"/>
        <result column="legalpersonname" jdbcType="VARCHAR" property="legalpersonname"/>
        <result column="estiblishtime" jdbcType="VARCHAR" property="estiblishtime" />
        <result column="fromtime" jdbcType="VARCHAR" property="fromtime"/>
        <result column="totime" jdbcType="VARCHAR" property="totime"/>
    </resultMap>

<!--    <select id="getMerchantsViewResults" resultType="com.fanruan.platform.bean.MerchantsViewResults">-->
<!--        SELECT  * FROM(-->
<!--        SELECT ROWNUM AS ROWNO, Y.* FROM(-->
<!--        SELECT Row_number()over(partition by X.CUSTOM_NAME order by X.UPDATETIME desc) rn, X.* FROM(-->
<!--        WITH ds1 as(-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        UNION-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        and b.NAME IS NOT NULL-->
<!--        UNION-->
<!--        SELECT '' AS DATE1-->
<!--        ,a.CUSTOM_SOCIAL_CODE-->
<!--        ,a.CUSTOM_NAME-->
<!--        ,'' AS "ID"-->
<!--        ,b.REASON AS "NAME"-->
<!--        ,'' AS COMPANYORGTYPE-->
<!--        ,'' AS REGCAPITAL-->
<!--        ,'' AS ESTIBLISHTIME-->
<!--        ,'' AS REGLOCATION-->
<!--        ,'' AS INDUSTRY-->
<!--        ,'' AS DS_CREDITCODE-->
<!--        ,'' AS GS_CREDITCODE-->
<!--        ,'' AS REGT_CREDIDTCODE-->
<!--        ,'' AS REG_CREDIDTCODE-->
<!--        ,'' AS FROMTIME-->
<!--        ,'' AS TOTIME-->
<!--        ,'' AS UPDATETIME-->
<!--        ,'' AS CREDIT_CODE-->
<!--        ,'' AS LEGALPERSONNAME-->
<!--        ,'' AS BASE-->
<!--        ,'' AS INVESTORNAME-->
<!--        ,'' AS ETL_FLAG-->
<!--        ,'' AS CREATETIME-->
<!--        ,0 AS TIMES-->
<!--        ,'' AS INPUT_NAME-->
<!--        ,'' AS BUSINESS_SCOPE-->
<!--        ,'' AS PHONE_NUMBER-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_JSON b-->
<!--        on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        b.error_code > '0'-->
<!--        AND b.JSONFLAG = '1001'-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        )-->
<!--        SELECT M.* FROM (-->
<!--        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a-->
<!--        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME-->
<!--        where 1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        )M-->
<!--        )X-->
<!--        )Y WHERE RN = 1)-->
<!--        WHERE 1=1-->
<!--        AND ROWNO &lt;= #{pageIndex} * #{pageSize}-->
<!--        AND ROWNO &gt; (#{pageIndex}-1) * #{pageSize}-->
<!--    </select>-->
    <select id="getMerchantsViewResults" resultType="com.fanruan.platform.bean.MerchantsViewResults">
        SELECT  * FROM(
        SELECT ROWNUM AS ROWNO, Y.* FROM(
        SELECT Row_number()over(partition by X.CUSTOM_NAME order by X.UPDATETIME desc) rn, X.* FROM(
        WITH ds1 as(
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        UNION
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        and b.NAME IS NOT NULL
        UNION
        SELECT '' AS DATE1
        ,a.CUSTOM_SOCIAL_CODE
        ,a.CUSTOM_NAME
        ,'' AS "ID"
        ,b.REASON AS "NAME"
        ,'' AS COMPANYORGTYPE
        ,'' AS REGCAPITAL
        ,'' AS ESTIBLISHTIME
        ,'' AS REGLOCATION
        ,'' AS INDUSTRY
        ,'' AS DS_CREDITCODE
        ,'' AS GS_CREDITCODE
        ,'' AS REGT_CREDIDTCODE
        ,'' AS REG_CREDIDTCODE
        ,'' AS FROMTIME
        ,'' AS TOTIME
        ,'' AS UPDATETIME
        ,'' AS CREDIT_CODE
        ,'' AS LEGALPERSONNAME
        ,'' AS BASE
        ,'' AS INVESTORNAME
        ,'' AS ETL_FLAG
        ,'' AS CREATETIME
        ,0 AS TIMES
        ,'' AS INPUT_NAME
        ,'' AS BUSINESS_SCOPE
        ,'' AS PHONE_NUMBER
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join (select id,name,jsonflag,max(updatetime),max(reason) as reason,max(error_code) as error_code from ODS_TYC_JSON  group by  id,name,jsonflag) b
        on a.CUSTOM_NAME = b.NAME
        where
        b.error_code > '0'
        AND b.JSONFLAG = '1001'
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        )
        SELECT M.* FROM (
        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a
        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME
        where 1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        )M
        )X
        )Y WHERE RN = 1)
        WHERE 1=1
        AND ROWNO &lt;= #{pageIndex} * #{pageSize}
        AND ROWNO &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getMerchantsViewExcelResultMap" type="com.fanruan.platform.bean.MerchantsViewResults">
        <result column="customName1" jdbcType="VARCHAR" property="customName1"/>
        <result column="customSocialCode" jdbcType="VARCHAR" property="customSocialCode"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="companyorgtype" jdbcType="VARCHAR" property="companyorgtype"/>
        <result column="industry" jdbcType="VARCHAR" property="industry"/>
        <result column="reglocation" jdbcType="VARCHAR" property="reglocation"/>
        <result column="businessScope" jdbcType="VARCHAR" property="businessScope"/>
        <result column="phoneNumber" jdbcType="VARCHAR" property="phoneNumber"/>
        <result column="regcapital" jdbcType="VARCHAR" property="regcapital"/>
        <result column="legalpersonname" jdbcType="VARCHAR" property="legalpersonname"/>
        <result column="estiblishtime" jdbcType="VARCHAR" property="estiblishtime" />
        <result column="fromtime" jdbcType="VARCHAR" property="fromtime"/>
        <result column="totime" jdbcType="VARCHAR" property="totime"/>
    </resultMap>

    <select id="getMerchantsViewExcel" resultType="com.fanruan.platform.bean.MerchantsViewResults">
        WITH ds1 as(
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        UNION
        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME
        where
        1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        and b.NAME IS NOT NULL
        UNION
        SELECT '' AS DATE1
        ,a.CUSTOM_SOCIAL_CODE
        ,a.CUSTOM_NAME
        ,'' AS "ID"
        ,b.REASON AS "NAME"
        ,'' AS COMPANYORGTYPE
        ,'' AS REGCAPITAL
        ,'' AS ESTIBLISHTIME
        ,'' AS REGLOCATION
        ,'' AS INDUSTRY
        ,'' AS DS_CREDITCODE
        ,'' AS GS_CREDITCODE
        ,'' AS REGT_CREDIDTCODE
        ,'' AS REG_CREDIDTCODE
        ,'' AS FROMTIME
        ,'' AS TOTIME
        ,'' AS UPDATETIME
        ,'' AS CREDIT_CODE
        ,'' AS LEGALPERSONNAME
        ,'' AS BASE
        ,'' AS INVESTORNAME
        ,'' AS ETL_FLAG
        ,'' AS CREATETIME
        ,0 AS TIMES
        ,'' AS INPUT_NAME
        ,'' AS BUSINESS_SCOPE
        ,'' AS PHONE_NUMBER
        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a
        inner join (select id,name,jsonflag,max(updatetime),max(reason) as reason,max(error_code) as error_code from ODS_TYC_JSON  group by  id,name,jsonflag) b
        on a.CUSTOM_NAME = b.NAME
        where
        b.error_code > '0'
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
        )
        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a
        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME
        where 1=1
        <if test="updataBy != null and updataBy !=''">
            and (a.UPDATEBY = #{updataBy})
        </if>
        <if test="serialid != null and serialid !=''">
            and (a.SERIALID = #{serialid})
        </if>
    </select>
<!--    <select id="getMerchantsViewExcel" resultType="com.fanruan.platform.bean.MerchantsViewResults">-->
<!--        WITH ds1 as(-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        UNION-->
<!--        SELECT substr(b.ESTIBLISHTIME,0,10) AS DATE1,a.CUSTOM_SOCIAL_CODE,a.CUSTOM_NAME,b.*-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_GSINFO b on a.CUSTOM_NAME = b.INPUT_NAME-->
<!--        where-->
<!--        1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        and b.NAME IS NOT NULL-->
<!--        UNION-->
<!--        SELECT '' AS DATE1-->
<!--        ,a.CUSTOM_SOCIAL_CODE-->
<!--        ,a.CUSTOM_NAME-->
<!--        ,'' AS "ID"-->
<!--        ,b.REASON AS "NAME"-->
<!--        ,'' AS COMPANYORGTYPE-->
<!--        ,'' AS REGCAPITAL-->
<!--        ,'' AS ESTIBLISHTIME-->
<!--        ,'' AS REGLOCATION-->
<!--        ,'' AS INDUSTRY-->
<!--        ,'' AS DS_CREDITCODE-->
<!--        ,'' AS GS_CREDITCODE-->
<!--        ,'' AS REGT_CREDIDTCODE-->
<!--        ,'' AS REG_CREDIDTCODE-->
<!--        ,'' AS FROMTIME-->
<!--        ,'' AS TOTIME-->
<!--        ,'' AS UPDATETIME-->
<!--        ,'' AS CREDIT_CODE-->
<!--        ,'' AS LEGALPERSONNAME-->
<!--        ,'' AS BASE-->
<!--        ,'' AS INVESTORNAME-->
<!--        ,'' AS ETL_FLAG-->
<!--        ,'' AS CREATETIME-->
<!--        ,0 AS TIMES-->
<!--        ,'' AS INPUT_NAME-->
<!--        ,'' AS BUSINESS_SCOPE-->
<!--        ,'' AS PHONE_NUMBER-->
<!--        FROM "BIUSER"."INPUT_CUSTOM_HAND"  a-->
<!--        inner join ODS_TYC_JSON b-->
<!--        on a.CUSTOM_NAME = b.NAME-->
<!--        where-->
<!--        b.error_code > '0'-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--        )-->
<!--        SELECT a.CUSTOM_NAME as CUSTOM_NAME1,a.CUSTOM_SOCIAL_CODE as customSocialCode,ds1.* from "BIUSER"."INPUT_CUSTOM_HAND" a-->
<!--        LEFT JOIN ds1 on a.CUSTOM_NAME=ds1.CUSTOM_NAME-->
<!--        where 1=1-->
<!--        <if test="updataBy != null and updataBy !=''">-->
<!--            and (a.UPDATEBY = #{updataBy})-->
<!--        </if>-->
<!--        <if test="serialid != null and serialid !=''">-->
<!--            and (a.SERIALID = #{serialid})-->
<!--        </if>-->
<!--    </select>-->


    <resultMap id="getAllBlackListResultListResultMap" type="com.fanruan.platform.bean.BlacklistResultList">
        <result column="pid" jdbcType="VARCHAR" property="pid" />
        <result column="entName" jdbcType="VARCHAR" property="entName" />
        <result column="startDate" jdbcType="VARCHAR" property="startDate" />
        <result column="reason" jdbcType="VARCHAR" property="reason" />
        <result column="grade" jdbcType="VARCHAR" property="grade" />
        <result column="publishBy" jdbcType="VARCHAR" property="publishBy" />
        <result column="publishDept" jdbcType="VARCHAR" property="publishDept" />
        <result column="publishTime" jdbcType="VARCHAR" property="publishTime" />
        <result column="status" jdbcType="VARCHAR" property="status" />
        <result column="reasonUrl" jdbcType="VARCHAR" property="reasonUrl" />
        <result column="type" jdbcType="VARCHAR" property="type" />
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="approveBy" jdbcType="VARCHAR" property="approveBy" />
        <result column="approveTime" jdbcType="VARCHAR" property="approveTime" />
        <result column="operationSelection" jdbcType="VARCHAR" property="operationSelection" />
        <result column="reasonsForRenewal" jdbcType="VARCHAR" property="reasonsForRenewal" />
    </resultMap>
    <select id="getAllBlackListResultList" resultType="com.fanruan.platform.bean.BlacklistResultList">
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.* from (
        SELECT DISTINCT a.company_name,a.credit_code,b.* from CREDIT_COMPANY a
        left join
        "BIUSER"."INPUT_BLACKLIST" b on a.credit_code = B.code
        where
        1=1
        <if test="status != null and status.size > 0">
            and b.status in
            <foreach collection="status" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="publishBy != null and publishBy !=''">
            and (b.PUBLISH_by  IN (SELECT PUBLISH_by
            FROM  INPUT_BLACKLIST
            WHERE #{publishBy}='admin'
            UNION
            SELECT PUBLISH_by
            FROM  INPUT_BLACKLIST
            WHERE PUBLISH_by=#{publishBy}
            AND PUBLISH_by != 'admin'
            ))
        </if>
        order by b.PUBLISH_TIME desc
               ,b.APPROVE_TIME desc
        )N
        )M
        WHERE 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getAllBlackListResultListCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>
    <select id="getAllBlackListResultListCount" resultType="java.lang.Integer">
        SELECT COUNT (1) as co from  (
            SELECT DISTINCT a.company_name,a.credit_code,b.* from CREDIT_COMPANY a
            left join
            "BIUSER"."INPUT_BLACKLIST" b on a.credit_code = B.code
            where
            1=1
        <if test="status != null and status.size > 0">
            and b.status in
            <foreach collection="status" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="publishBy != null and publishBy !=''">
            and (b.PUBLISH_by  IN (SELECT PUBLISH_by
            FROM  INPUT_BLACKLIST
            WHERE #{publishBy}='admin'
            UNION
            SELECT PUBLISH_by
            FROM  INPUT_BLACKLIST
            WHERE PUBLISH_by=#{publishBy}
            AND PUBLISH_by != 'admin'
            ))
        </if>
            order by b.status,case when GRADE = '高' then 0
            when GRADE = '中' then 1
            else 3 end,b.UPDATETIME desc
        )
    </select>

    <resultMap id="getCompayNameAndCreditCodeResultMap" type="com.fanruan.platform.bean.CompayNameCode">
        <result column="companyName" jdbcType="VARCHAR" property="companyName" />
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
    </resultMap>
    <select id="getCompayNameAndCreditCode" resultType="com.fanruan.platform.bean.CompayNameCode">
        SELECT DISTINCT a.company_name,a.credit_code from CREDIT_COMPANY a
    </select>


    <resultMap id="getLevelCompanyNameResultMap" type="java.lang.String">
        <result column="COMPANYNAME" jdbcType="VARCHAR" property="COMPANYNAME" />
    </resultMap>
    <select id="getLevelCompanyName" resultType="java.lang.String">
        SELECT COMPANYNAME FROM VIEW_ORG
        WHERE COMPANYNAME IN
        (
        select COMPANYNAME from VIEW_ORG WHERE 1 = 1

        <if test="CompanyName != null and CompanyName !=''">
            and (SUBCOMPANYNAME = #{CompanyName})
        </if>
        )
        AND COMPANYNAME= SUBCOMPANYNAME
        --AND TP = '2'
    </select>


    <resultMap id="getApproveByResultMap" type="java.lang.String">
        <result column="USERNAME" jdbcType="VARCHAR" property="USERNAME" />
    </resultMap>
    <select id="getApproveBy" resultType="java.lang.String">
        SELECT U.USERNAME
        FROM CREDIT_USER U
        WHERE U.ROLE_NAME = '审核专员'
        AND U.COMPANY_NAME IN
        (SELECT SUBCOMPANYNAME
        FROM VIEW_ORG
        WHERE COMPANYNAME =(SELECT COMPANYNAME FROM VIEW_ORG
        WHERE COMPANYNAME IN (select COMPANYNAME from VIEW_ORG
        WHERE 1 = 1
        <if test="approveBy != null and approveBy !=''">
            and (SUBCOMPANYNAME = #{approveBy})
        </if>
        )
        AND COMPANYNAME= SUBCOMPANYNAME
        AND TP = '2')
        )

    </select>

    <resultMap id="getAllHistoricalReportResultMap" type="com.fanruan.platform.bean.Report">
        <result column="reportId" jdbcType="INTEGER" property="reportId" />
        <result column="orderId" jdbcType="VARCHAR" property="orderId" />
        <result column="fileName" jdbcType="VARCHAR" property="fileName" />
        <result column="pdfName" jdbcType="VARCHAR" property="pdfName" />
        <result column="companyName" jdbcType="VARCHAR" property="companyName" />
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="reportType" jdbcType="VARCHAR" property="reportType" />
        <result column="updateBy" jdbcType="VARCHAR" property="updateBy" />
        <result column="reportHtml" jdbcType="BLOB" property="reportHtml" />
        <result column="area" jdbcType="VARCHAR" property="area" />
        <result column="industry" jdbcType="VARCHAR" property="industry" />
        <result column="companyType" jdbcType="VARCHAR" property="companyType" />
        <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime" />
    </resultMap>
    <select id="getAllHistoricalReport" resultType="com.fanruan.platform.bean.Report">
        SELECT * FROM
        (SELECT ROW_NUMBER() OVER(PARTITION BY report_type ORDER BY update_time DESC)rn, t.*FROM CREDIT_REPORT t
         where 1 = 1
            and t.pdf_name is not null
        <if test="creditCode != null and creditCode !=''">
            and ( t.credit_code  = #{creditCode})
        </if>
         )
        WHERE rn = 1
    </select>

    <resultMap id="getBlacklistApprovalListResultMap" type="com.fanruan.platform.bean.BlacklistResultList">
        <result column="pid" jdbcType="VARCHAR" property="pid" />
        <result column="entName" jdbcType="VARCHAR" property="entName" />
        <result column="startDate" jdbcType="VARCHAR" property="startDate" />
        <result column="reason" jdbcType="VARCHAR" property="reason" />
        <result column="grade" jdbcType="VARCHAR" property="grade" />
        <result column="publishBy" jdbcType="VARCHAR" property="publishBy" />
        <result column="publishDept" jdbcType="VARCHAR" property="publishDept" />
        <result column="publishTime" jdbcType="VARCHAR" property="publishTime" />
        <result column="status" jdbcType="VARCHAR" property="status" />
        <result column="reasonUrl" jdbcType="VARCHAR" property="reasonUrl" />
        <result column="type" jdbcType="VARCHAR" property="type" />
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="approveBy" jdbcType="VARCHAR" property="approveBy" />
        <result column="approveTime" jdbcType="VARCHAR" property="approveTime" />
        <result column="operationSelection" jdbcType="VARCHAR" property="operationSelection" />
        <result column="reasonsForRenewal" jdbcType="VARCHAR" property="reasonsForRenewal" />
        <result column="approveRemarks" jdbcType="VARCHAR" property="approveRemarks" />
        <result column="cancelBy" jdbcType="VARCHAR" property="cancelBy" />
        <result column="cancelTime" jdbcType="VARCHAR" property="cancelTime" />
        <result column="cancelReason" jdbcType="VARCHAR" property="cancelReason"/>
    </resultMap>
    <select id="getBlacklistApprovalList" resultType="com.fanruan.platform.bean.BlacklistResultList">
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.* from (
       SELECT DISTINCT
	    a.company_name,
	    a.credit_code,
	    b.*
        FROM
	    CREDIT_COMPANY a
	    LEFT JOIN "BIUSER"."INPUT_BLACKLIST" b ON a.credit_code = B.code
        WHERE
	    1 = 1
        <if test="status != null and status.size > 0">
            and b.status in
            <foreach collection="status" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
		AND b.PID IS NOT NULL
	    AND b.status != 4
        AND b.companyname in
        (
        SELECT DISTINCT O.SUBCOMPANYNAME --二级公司
        FROM ODS_HR_PSNDOC A
        LEFT JOIN VIEW_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
        WHERE  A.CODE=#{userName}
        AND O.TP IN (1,2)
        UNION
        SELECT DISTINCT O.SUBCOMPANYNAME --管理员
        FROM  VIEW_ORG O
        WHERE #{userName} = 'admin'
        AND O.TP IN (1,2)
        )
        order by b.PUBLISH_TIME desc
        ,b.APPROVE_TIME desc
        )N
        )M
        WHERE 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getBlacklistApprovalListCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>
    <select id="getBlacklistApprovalListCount" resultType="java.lang.Integer">
        SELECT COUNT (1) as co from  (
        SELECT DISTINCT
        a.company_name,
        a.credit_code,
        b.*
        FROM
        CREDIT_COMPANY a
        LEFT JOIN "BIUSER"."INPUT_BLACKLIST" b ON a.credit_code = B.code
        WHERE
        1 = 1
        <if test="status != null and status.size > 0">
            and b.status in
            <foreach collection="status" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        AND b.PID IS NOT NULL
        AND b.status != 4
        and b.companyname in
        (
        SELECT DISTINCT O.SUBCOMPANYNAME --二级公司
        FROM ODS_HR_PSNDOC A
        LEFT JOIN VIEW_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
        WHERE  A.CODE=#{userName}
        AND O.TP IN (1,2)
        UNION
        SELECT DISTINCT O.SUBCOMPANYNAME --管理员
        FROM  VIEW_ORG O
        WHERE #{userName} = 'admin'
        AND O.TP IN (1,2)
        )
        ORDER BY
        b.status,
        CASE

        WHEN GRADE = '高' THEN
        0
        WHEN GRADE = '中' THEN
        1 ELSE 3
        END,
        b.UPDATETIME DESC
        )
    </select>

    <resultMap id="getBlacklistApprovalExcelResultMap" type="com.fanruan.platform.bean.BlacklistResultList">
        <result column="pid" jdbcType="VARCHAR" property="pid" />
        <result column="entName" jdbcType="VARCHAR" property="entName" />
        <result column="startDate" jdbcType="VARCHAR" property="startDate" />
        <result column="reason" jdbcType="VARCHAR" property="reason" />
        <result column="grade" jdbcType="VARCHAR" property="grade" />
        <result column="publishBy" jdbcType="VARCHAR" property="publishBy" />
        <result column="publishDept" jdbcType="VARCHAR" property="publishDept" />
        <result column="publishTime" jdbcType="VARCHAR" property="publishTime" />
        <result column="status" jdbcType="VARCHAR" property="status" />
        <result column="reasonUrl" jdbcType="VARCHAR" property="reasonUrl" />
        <result column="type" jdbcType="VARCHAR" property="type" />
        <result column="creditCode" jdbcType="VARCHAR" property="creditCode" />
        <result column="approveBy" jdbcType="VARCHAR" property="approveBy" />
        <result column="approveTime" jdbcType="VARCHAR" property="approveTime" />
        <result column="operationSelection" jdbcType="VARCHAR" property="operationSelection" />
        <result column="reasonsForRenewal" jdbcType="VARCHAR" property="reasonsForRenewal" />
        <result column="approveRemarks" jdbcType="VARCHAR" property="approveRemarks" />
        <result column="cancelBy" jdbcType="VARCHAR" property="cancelBy" />
        <result column="cancelTime" jdbcType="VARCHAR" property="cancelTime" />
        <result column="cancelReason" jdbcType="VARCHAR" property="cancelReason"/>
    </resultMap>
    <select id="getBlacklistApprovalExcel" resultType="com.fanruan.platform.bean.BlacklistResultList">
        SELECT DISTINCT
        a.company_name,
        a.credit_code,
        b.*
        FROM
        CREDIT_COMPANY a
        LEFT JOIN "BIUSER"."INPUT_BLACKLIST" b ON a.credit_code = B.code
        WHERE
        1 = 1
        <if test="status != null and status.size > 0">
            and b.status in
            <foreach collection="status" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        AND b.PID IS NOT NULL
        AND b.status != 4
        AND b.companyname in
        (
        SELECT DISTINCT O.SUBCOMPANYNAME --二级公司
        FROM ODS_HR_PSNDOC A
        LEFT JOIN VIEW_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
        WHERE  A.CODE=#{userName}
        AND O.TP IN (1,2)
        UNION
        SELECT DISTINCT O.SUBCOMPANYNAME --管理员
        FROM  VIEW_ORG O
        WHERE #{userName} = 'admin'
        AND O.TP IN (1,2)
        )
        ORDER BY
        b.status,
        CASE

        WHEN GRADE = '高' THEN
        0
        WHEN GRADE = '中' THEN
        1 ELSE 3
        END,
        b.UPDATETIME DESC

    </select>

    <resultMap id="getCompayNameListResultMap" type="java.lang.String">
        <result column="entName" jdbcType="VARCHAR" property="entName" />
    </resultMap>
    <select id="getCompayNameList" resultType="java.lang.String">
      SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN
       WHERE CONCERN_FLAG=1
        AND
        UPDATEBY= #{userName}
    </select>

    <resultMap id="getEventTypeListResultMap" type="java.lang.String">
        <result column="TYPENAME" jdbcType="VARCHAR" property="TYPENAME" />
    </resultMap>
    <select id="getEventTypeList" resultType="java.lang.String">
             select distinct TYPENAME from ODS_TYC_PUSHSTRUCT P
              LEFT JOIN ODS_TYC_TYPE T ON P.TYPEA=T.TYPE
              WHERE COMPANYNAME in
              (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY = #{userName})
                <if test="riskleve != null and riskleve.size > 0">
                    and RISKLEVEL in
                    <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
                <if test="companyName != null and companyName.size > 0">
                    and COMPANYNAME in
                    <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                        #{item}
                    </foreach>
                </if>
              AND TO_CHAR(UPDATETIME,'YYYY-MM-DD')
              BETWEEN #{startDate} AND #{endDate}
    </select>


    <resultMap id="getRealTimeWarningResultMap" type="com.fanruan.platform.bean.RealTimeWarning">
        <result column="typea" jdbcType="INTEGER" property="typea" />
        <result column="typeName" jdbcType="VARCHAR" property="typeName" />
        <result column="companyGid" jdbcType="VARCHAR" property="companyGid" />
        <result column="companyName" jdbcType="VARCHAR" property="companyName" />
        <result column="riskLevel" jdbcType="VARCHAR" property="riskLevel" />
        <result column="updateTime" jdbcType="VARCHAR" property="updateTime" />
        <result column="A" jdbcType="VARCHAR" property="A" />
        <result column="B" jdbcType="VARCHAR" property="B" />
        <result column="URL" jdbcType="VARCHAR" property="URL" />
    </resultMap>
    <select id="getRealTimeWarning" resultType="com.fanruan.platform.bean.RealTimeWarning">

        WITH ds1 as(SELECT
        TYPEA,
        '工商变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '变更事项:'||to_clob(CHANGEITEM)||';   变更前:'||to_clob(CONTENTBEFORE)||';   变更后:'||to_clob(CONTENTAFTER) as A,
        '变更时间:'||TO_CHAR(CHANGETIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=11
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '上市公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告标题:'||to_clob(ANNOUNCEMENTTITLE) as A,
        '公告时间:'||TO_CHAR(ANNOUNCEMENTTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=13
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '融资历史' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '投资企业:'||to_clob(INVESTORNAME)||';   金额:'||to_clob(MONEY)||';   投资公司:'||to_clob(ORGANIZATIONNAME)||';   轮次:'||to_clob(ROUND) as A,
        '融资时间:'||TO_CHAR("DATE" /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01','YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=21
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '核心团队' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        to_clob(TITLE)||':'||to_clob(NAME) as A,
        "DESC" as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=22
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '企业业务' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '产品:'||to_clob(PRODUCT)||';   业务:'||to_clob(YEWU)||';   行业:'||to_clob(HANGYE) as A,
        '介绍:'||INTRO as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=23
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '投资事件' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '投资公司:'||to_clob(ORGANIZATIONNAME)||';   地区:'||to_clob(LOCATION)||';   业务范围:'||to_clob(YEWU)||';   行业:'||to_clob(HANGYE1)||';   产品名:'||to_clob(PRODUCT)||';   金额:'||to_clob(MONEY)||';   轮次:'||to_clob(LUNCI) as A,
        '投资时间:'||TO_CHAR(TZDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=24
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        union all

        SELECT
        TYPEA,
        '裁判文书' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:《'||TITLE||'》;   案件类型:'||CASETYPE||';   案号:'||CASENO||';   法院:'||COURT||';   案由:'||to_clob(CASEREASON) as A,
        '发布时间:'||TO_CHAR(SUBMITTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=31
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '法院公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告类型:'||to_clob(BLTNTYPENAME)||';   案件内容:'||to_clob(CONTENT)||';   法院:'||to_clob(COURTCODE)||';   原因:'||to_clob(REASON) as A,
        '刊登日期:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=32
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '失信被执行人' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '失信人名称:'||to_clob(INAME)||';   执行依据文号:'||GISTID||';   法院:'||COURTNAME||';   生效法律文书确定的义务:'||to_clob(DUTY)||';   履行情况:'||to_clob(PERFORMANCE) as A,
        '发布日期:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=33
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '被执行人' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASECODE||';   执行法院:'||EXECCOURTNAME||';   被执行人名称:'||PNAME||';   执行标的:'||to_clob(EXECMONEY) as A,
        '创建时间:'||TO_CHAR(CASECREATETIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=34
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        union all

        SELECT
        TYPEA,
        '开庭公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASEREASON2||';   法院:'||COURT||';   原告/上诉人:'||PLAINTIFF||';   被告/被上诉人:'||DEFENDANT||';   案由'||to_clob(CASEREASON) as A,
        '开庭日期:'||TO_CHAR(STARTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=35
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '司法协助' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '执行通知书文号:'||EXECUTENOTICENUM||';   类型/状态:'||TYPESTATE||';   执行法院:'||to_clob(EXECUTIVECOURT)||';   被执行人:'||EXECUTEDPERSON||';   股权数额'||EQUITYAMOUNT as A,
        null as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=36
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '经营异常' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '列入部门:'||PUTDEPARTMENT||';   列入原因:'||to_clob(PUTREASON)||';   移除部门:'||REMOVEDEPARTMENT||';   移除原因:'||to_clob(REMOVEREASON) as A,
        '列入日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    移除日期:'||TO_CHAR(REMOVEDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=41
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '行政处罚(工商局)' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '定书文号:'||PUNISHNUMBER||';   行政处罚内容:'||to_clob(CONTENT)||';   描述:'||to_clob(DESCRIPTION)||';   违法行为类型:'||"TYPE" as A,
        '决定日期:'||TO_CHAR(DECISIONDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=42
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '严重违法' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '列入部门:'||PUNISHNUMBER||';   列入原因:'||to_clob(PUTREASON)||';   移除部门:'||REMOVEDEPARTMENT||';   移除原因:'||to_clob(REMOVEREASON) as A,
        '列入日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    移除日期:'||TO_CHAR(REMOVEDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=43
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '股权出质' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '注册号:'||REGNUMBER||';   出质人:'||PLEDGOR||';   质权人:'||to_clob(PLEDGEE)||';   出质股权数额:'||EQUITYAMOUNT||';   状态:'||STATE as A,
        '股权出质设立登记日期:'||TO_CHAR(REGDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    股权出质设立发布日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=44
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '欠税公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人识别号:'||TAXIDNUMBER||';   法人或负责人名称:'||to_clob(LEGALPERSONNAME)||';   纳税人类型:'||TAXPAYERTYPE||';   税务类型:'||"TYPE"||';   欠税税种:'||TAXCATEGORY||';   欠税金额:'||OWNTAXAMOUNT||';   欠税余额:'||OWNTAXBALANCE||';   当前新发生欠税余额:'||NEWOWNTAXBALANCE as A,
        '发布时间:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=46
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '司法拍卖' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:'||TITLE||';   描述:'||to_clob(INTRODUCTION)||';   详细内容:'||to_clob(DETAIL) as A,
        '公告日期:'||TO_CHAR(PUBTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=47
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '清算信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '清算组负责人:'||to_clob(MANAGER)||';   清算成员名称:'||MEMBER as A,
        null as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=48
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '知识产权出质' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '知识产权登记证号:'||CERTIFICATENUM||';   种类:'||"TYPE"||';   出质人名称:'||to_clob(PLEDGOR)||';   质权人名称:'||PLEDGEE||';   状态:'||STATE as A,
        '公示日期:'||TO_CHAR(PUBLICITYDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=49
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        UNION ALL

        SELECT
        TYPEA,
        '行政处罚【信用中国】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '区域:'||AREANAME||';   处罚事由:'||to_clob(REASON)||';    处罚结果:'||to_clob(RESULT)||';   决定机关:'||DEPARTMENTNAME as A,
        '决定日期:'||TO_CHAR(DECISIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=410
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '招投标' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:'||TITLE||';   正文简介:'||to_clob(INTRO)||';    采购人:'||PURCHASER||';   代理机构:'||PROXY as A,
        '发布时间:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=51
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '债券信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '债券名称:'||to_clob(BONDNAME)||';   债券代码:'||BONDNUM||';    债券类型 :'||BONDTYPE||';   计息方式 :'||CALINTERESTTYPE||'; 债项评级:'||DEBTRATING||'; 信用评级机构:'||CREDITRATINGGOV
        ||'; 托管机构:'||ESCROWAGENT||'; 行权类型:'||EXERIGHTTYPE||'; 票面利率(%):'||FACEINTERESTRATE||'; 面值:'||FACEVALUE||';  流通范围: '||FLOWRANGE||'; 发行价格(元):'||ISSUEDPRICE||'; 付息频率:'||PAYINTERESTHZ
        ||'; 实际发行量(亿) :'||REALISSUEDQUANTITY||'; 发行人:'||PUBLISHERNAME||'; 债券起息日'
        as A,
        '上市交易日:'||TO_CHAR(BONDTRADETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 行权日期:'||TO_CHAR(EXERIGHTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债劵到期日:'||TO_CHAR(PUBLISHEXPIRETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债劵发行日:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债券起息日:'||TO_CHAR(STARTCALINTERESTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        BIDURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=52
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '购地信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '宗地位置:'||To_clob(LOCATION)||';   供地总面积(公顷):'||TOTALAREA||';    成交价款（万元） :'||DEALPRICE||';   供应方式 :'||SUPPLYWAY||'; 土地用途:'||PURPOSE||'; 受让人:'||ASSIGNEE
        ||'; 上级公司:'||PARENTCOMPANY
        as A,
        '约定竣工时间:'||TO_CHAR(ENDTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        LINKURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=53
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '税务评级' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人识别号:'||to_clob(NUMBER2)||';   纳税等级:'||GRADE||';    类别:'||CASE TYPE WHEN '0' THEN '国税' ELSE '地税' END||';   评价单位 :'||EVALDEPARTMENT
        as A,
        '年份:'||YEAR
        as B,
        LINKURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=55
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '抽查检查' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '结果:'||to_clob(CHECKRESULT)||';   类型:'||CHECKTYPE||';    实施机关:'||CHECKORG
        as A,
        '日期:'||TO_CHAR(CHECKDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=56
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '产品信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '产品名:'||NAME||';   描述:'||to_clob(BRIEF)||';    产品分类:'||TYPE||'; 领域'||CLASSES
        as A,
        NULL
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=57
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '行政许可【工商局】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||NUMBER2||';   许可证名称:'||NAME||';    等级:'||GRADE||'; 范围'||to_clob(SCOPE)||'; 证书状态 '||STATE||'; 发证机关'||DEPARTMENT
        as A,
        '起始日期:'||FROMDATE||'; 到期日期'||TODATE
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=511
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '行政许可【信用中国】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||NUMBER2||';   内容许可:'||to_clob(CONTENT)||';    许可机关:'||DEPARTMENT||'; 审核类型'||AUDITYPE||'; 证书状态 '||STATE||'; 许可机关'||DEPARTMENT
        as A,
        '许可决定日期:'||TO_CHAR(DECISIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||'; 许可截止日期'||TO_CHAR(ENDDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=512
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '商标信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '国际分类code:'||TMCLASS||';   商标名称:'||to_clob(TMNAME)||';    状态:'||STATUS||';  国际分类'||INTCLS||'; 商标状态 '||CATEGORY||'; 商标图片'||TMPIC||'; 注册号'||REGNO||';  申请人'||APPLICANTCN
        as A,
        '申请日期:'||TO_CHAR(APPDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=61
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '专利信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '专利名称:'||PATENTNAME||';   专利类型:'||PATENTTYPE||';    摘要:'||to_clob(ABSTRACTS)||';  申请号/专利号'||PATENTNUM||';  全部分类号 '||ALLCATNUM||'; 主分类号'||MAINCATNUM||'; 发明人'||INVENTOR||';  代理人'||AGENT||'; 代理机构'||AGENCY||'; 申请人 '||APPLICANTNAME
        as A,
        '申请日:'||TO_CHAR(APPLICATIONTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 公开公告日:'||TO_CHAR(PUBDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        IMGURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=62
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '软件著作权' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '软件名称:'||to_clob(FULLNAME)||';   版本号:'||VERSION||';    著作权人(国籍):'||AUTHORNATIONALITY||';  登记号'||REGNUM||';  分类号 '||CATNUM
        as A,
        '首次发表时间:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 登记时间:'||TO_CHAR(REGTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        IMGURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=63
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '作品著作权' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '作品名称:'||to_clob(FULLNAME)||';   作品类别:'||TYPE||';    著作权人名称:'||AUTHORNATIONALITY||';  登记号'||REGNUM
        as A,
        '登记日期:'||TO_CHAR(REGTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 创作完成日期:'||TO_CHAR(FINISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=64
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '送达公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告名称:'||TITLE||';   法院名称:'||COURT||';    详情:'||to_clob(CONTENT)
        as A,
        '发布日期:'||TO_CHAR(STARTDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=79
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '立案信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 案号:'||CASENO||';    案件类型:'||CASETYPE||';    案件状态:'||to_clob(CASESTATUS)||'; 法院:'||COURT||';  承办部门:'||DEPARTMENT||';  承办法官:'||JUDGE||'; 原告:'||PLAINTIFF||'; 被告:'||DEFENDANT||';  第三人:'||THIRD
        as A,
        '立案日期:'||TO_CHAR(FILINGDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 开庭日期:'||TO_CHAR(STARTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        ';  结束日期'||TO_CHAR(CLOSEDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=80
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '税收违法' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人名称:'||TAXPAYERNAME||';    违法情况:'||to_clob(CASEINFO)||';    案件性质:'||CASETYPE||';  纳税人识别号:'||TAXPAYERNUMBER||';  所属税务机关:'||DEPARTMENT||';  组织机构代码:'||TAXPAYERCODE
        as A,
        NULL
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE  TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=81
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '简易注销' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 统一社会信用代码:'||CREDITCODE||';    登记机关:'||to_clob(REGAUTHORITY)||';    公告期:'||ANNOUNCEMENTTERM
        as A,
        NULL
        as B,
        INVESTORCOMMITMENTDOWNLOADURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=82
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '环保处罚' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 处罚结果:'||EXECUTION||';    处罚单位:'||PUNISHDEPARTMENT||';    处罚事由:'||to_clob(PUNISHREASON)||'; 处罚依据:'||to_clob(PUNISHBASIS)||';  违反法律:'||to_clob(LAWBREAKING)||';  决定文书号:'||PUNISHNUMBER
        as A,
        '处罚日期:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=83
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '公示催告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '票据号:'||BILLNUM||';    票据类型:'||BILLTYPE||';    票面金额:'||BILLAMT||'; 持票人:'||OWNERCOMPANYNAME||';   出票人:'||DRAWCOMPANYNAME||';   付款银行:'||PAYCOMPANYNAME||'; 公告内容:'||to_clob(INFODETAIL)
        as A,
        '出票日:'||TO_CHAR(BILLBEGINDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'到期日 :'||TO_CHAR(BILLENDDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'公告日期:'||TO_CHAR(PUBLISHDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=84
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '土地抵押' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '抵押面积(公顷):'||MORTGAGEAREA||';    票据类型:'||BILLTYPE||';    票面金额:'||BILLAMT||'; 持票人:'||OWNERCOMPANYNAME||';   出票人:'||DRAWCOMPANYNAME||';   付款银行:'||PAYCOMPANYNAME||'; 公告内容:'||to_clob(INFODETAIL)
        as A,
        '出票日:'||TO_CHAR(BILLBEGINDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'到期日 :'||TO_CHAR(BILLENDDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'公告日期:'||TO_CHAR(PUBLISHDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=85
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '土地转让' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '土地面积(公顷):'||AREA||';    土地级别:'||LEVEL3||';    原土地使用权人:'||USERCHANGEPRE||'; 转让方式:'||to_clob(MERCHANDISETYPE)||';    土地使用权类型:'||USETYPE||';   土地使用年限:'||PAYCOMPANYNAME||'; 转让价格(万元）:'||MERCHANDISPRICE||'; 现土地使用权人:'||USERCHANGENOW||';  土地用途:'||USEFUL||'; 土地利用状况:'||SITUATION
        as A,
        '成交日期:'||TO_CHAR(MERCHANDISETIMECLEAN/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=86
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '地块公示' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '项目名称'||PROJECTNAME||'土地面积(公顷):'||LANDAREA||';    地块位置:'||LANDLOCATION||';     受让单位:'||LANDUSERIGHTPERSON||'; 土地用途:'||LANDUSEFULNESS||';    公示期:'||PUBLICANNOUNCEMENTPERIOD||';   意见反馈方式:'||to_clob(FEEDBACKMETHOD)||';  发布机关 :'||PUBLICATIONORGANIZE
        as A,
        '发布日期:'||TO_CHAR(PUBLICATIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=87
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '电信许可' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||LICENSENUMBER||' 业务及其覆盖范围:'||to_clob(BUSINESSSCOPE)||';    是否有效:'||ISAVAILABLE
        as A,
        null
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=88
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '限制消费令' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '姓名:'||XNAME||' 企业信息:'||to_clob(QYINFO)||';    是否有效:'||ISAVAILABLE
        as A,
        '立案日期:'||TO_CHAR(CASECREATETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=89
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '终本案件' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASECODE||' 身份证号码/组织机构代码:'||PARTYCARDNUM||';     执行法院:'||to_clob(EXECCOURTNAME)||';  执行标的:'||EXECMONEY||';  未履行金额:'||NOEXECMONEY
        as A,
        '终本日期:'||TO_CHAR(CASEFINALTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 立案日期:'||TO_CHAR(CASECREATETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=90
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '大股东变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '现大股东名称:'||to_clob(BIGSHAREHOLDER)||' 原大股东名称:'||BIGSHAREHOLDERBEFORE
        as A,
        null
        as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE  TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=116
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '股权变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '股东名称:'||to_clob(SHAREHOLDERNAME)||'; 原出资比例:'||PERCENTBEFORE||';     现出资比例:'||PERCENT||';  原认缴出资额:'||CAPITALBEFORE||';  现认缴出资额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=122
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '退出对外投资' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '被投资企业名称:'||to_clob(NAME)||'; 投资数额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=120
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '新增对外投资' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '被投资企业名称:'||to_clob(NAME)||'; 投资数额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=121
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '新闻舆情' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '新闻标题:'||TITLE||';    来源:'||to_clob(SOURCE)
        as A,
        NULL as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=3001
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        )
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.*
        FROM (
        SELECT * FROM ds1
        where 1=1
        <if test="eventType != null and eventType.size > 0">
        and TYPENAME in
        <foreach collection="eventType" index="index" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </if>
        ORDER BY UPDATETIME DESC
        ) N
     )M
        WHERE 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}

    </select>


    <resultMap id="getRealTimeWarningCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

    <select id="getRealTimeWarningCount" resultType="java.lang.Integer">

        WITH ds1 as(SELECT
        TYPEA,
        '工商变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '变更事项:'||to_clob(CHANGEITEM)||';   变更前:'||to_clob(CONTENTBEFORE)||';   变更后:'||to_clob(CONTENTAFTER) as A,
        '变更时间:'||TO_CHAR(CHANGETIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=11
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '上市公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告标题:'||to_clob(ANNOUNCEMENTTITLE) as A,
        '公告时间:'||TO_CHAR(ANNOUNCEMENTTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=13
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '融资历史' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '投资企业:'||to_clob(INVESTORNAME)||';   金额:'||to_clob(MONEY)||';   投资公司:'||to_clob(ORGANIZATIONNAME)||';   轮次:'||to_clob(ROUND) as A,
        '融资时间:'||TO_CHAR("DATE" /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01','YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=21
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '核心团队' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        to_clob(TITLE)||':'||to_clob(NAME) as A,
        "DESC" as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=22
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '企业业务' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '产品:'||to_clob(PRODUCT)||';   业务:'||to_clob(YEWU)||';   行业:'||to_clob(HANGYE) as A,
        '介绍:'||INTRO as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=23
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '投资事件' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '投资公司:'||to_clob(ORGANIZATIONNAME)||';   地区:'||to_clob(LOCATION)||';   业务范围:'||to_clob(YEWU)||';   行业:'||to_clob(HANGYE1)||';   产品名:'||to_clob(PRODUCT)||';   金额:'||to_clob(MONEY)||';   轮次:'||to_clob(LUNCI) as A,
        '投资时间:'||TO_CHAR(TZDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=24
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        union all

        SELECT
        TYPEA,
        '裁判文书' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:《'||TITLE||'》;   案件类型:'||CASETYPE||';   案号:'||CASENO||';   法院:'||COURT||';   案由:'||to_clob(CASEREASON) as A,
        '发布时间:'||TO_CHAR(SUBMITTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=31
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '法院公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告类型:'||to_clob(BLTNTYPENAME)||';   案件内容:'||to_clob(CONTENT)||';   法院:'||to_clob(COURTCODE)||';   原因:'||to_clob(REASON) as A,
        '刊登日期:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=32
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '失信被执行人' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '失信人名称:'||to_clob(INAME)||';   执行依据文号:'||GISTID||';   法院:'||COURTNAME||';   生效法律文书确定的义务:'||to_clob(DUTY)||';   履行情况:'||to_clob(PERFORMANCE) as A,
        '发布日期:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=33
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '被执行人' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASECODE||';   执行法院:'||EXECCOURTNAME||';   被执行人名称:'||PNAME||';   执行标的:'||to_clob(EXECMONEY) as A,
        '创建时间:'||TO_CHAR(CASECREATETIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=34
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        union all

        SELECT
        TYPEA,
        '开庭公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASEREASON2||';   法院:'||COURT||';   原告/上诉人:'||PLAINTIFF||';   被告/被上诉人:'||DEFENDANT||';   案由'||to_clob(CASEREASON) as A,
        '开庭日期:'||TO_CHAR(STARTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=35
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '司法协助' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '执行通知书文号:'||EXECUTENOTICENUM||';   类型/状态:'||TYPESTATE||';   执行法院:'||to_clob(EXECUTIVECOURT)||';   被执行人:'||EXECUTEDPERSON||';   股权数额'||EQUITYAMOUNT as A,
        null as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=36
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '经营异常' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '列入部门:'||PUTDEPARTMENT||';   列入原因:'||to_clob(PUTREASON)||';   移除部门:'||REMOVEDEPARTMENT||';   移除原因:'||to_clob(REMOVEREASON) as A,
        '列入日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    移除日期:'||TO_CHAR(REMOVEDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=41
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '行政处罚(工商局)' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '定书文号:'||PUNISHNUMBER||';   行政处罚内容:'||to_clob(CONTENT)||';   描述:'||to_clob(DESCRIPTION)||';   违法行为类型:'||"TYPE" as A,
        '决定日期:'||TO_CHAR(DECISIONDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=42
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '严重违法' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '列入部门:'||PUNISHNUMBER||';   列入原因:'||to_clob(PUTREASON)||';   移除部门:'||REMOVEDEPARTMENT||';   移除原因:'||to_clob(REMOVEREASON) as A,
        '列入日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    移除日期:'||TO_CHAR(REMOVEDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=43
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '股权出质' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '注册号:'||REGNUMBER||';   出质人:'||PLEDGOR||';   质权人:'||to_clob(PLEDGEE)||';   出质股权数额:'||EQUITYAMOUNT||';   状态:'||STATE as A,
        '股权出质设立登记日期:'||TO_CHAR(REGDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||';    股权出质设立发布日期:'||TO_CHAR(PUTDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=44
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '欠税公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人识别号:'||TAXIDNUMBER||';   法人或负责人名称:'||to_clob(LEGALPERSONNAME)||';   纳税人类型:'||TAXPAYERTYPE||';   税务类型:'||"TYPE"||';   欠税税种:'||TAXCATEGORY||';   欠税金额:'||OWNTAXAMOUNT||';   欠税余额:'||OWNTAXBALANCE||';   当前新发生欠税余额:'||NEWOWNTAXBALANCE as A,
        '发布时间:'||TO_CHAR(PUBLISHDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=46
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '司法拍卖' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:'||TITLE||';   描述:'||to_clob(INTRODUCTION)||';   详细内容:'||to_clob(DETAIL) as A,
        '公告日期:'||TO_CHAR(PUBTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=47
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '清算信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '清算组负责人:'||to_clob(MANAGER)||';   清算成员名称:'||MEMBER as A,
        null as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=48
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        union all

        SELECT
        TYPEA,
        '知识产权出质' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '知识产权登记证号:'||CERTIFICATENUM||';   种类:'||"TYPE"||';   出质人名称:'||to_clob(PLEDGOR)||';   质权人名称:'||PLEDGEE||';   状态:'||STATE as A,
        '公示日期:'||TO_CHAR(PUBLICITYDATE /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=49
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>



        UNION ALL

        SELECT
        TYPEA,
        '行政处罚【信用中国】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '区域:'||AREANAME||';   处罚事由:'||to_clob(REASON)||';    处罚结果:'||to_clob(RESULT)||';   决定机关:'||DEPARTMENTNAME as A,
        '决定日期:'||TO_CHAR(DECISIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=410
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '招投标' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '标题:'||TITLE||';   正文简介:'||to_clob(INTRO)||';    采购人:'||PURCHASER||';   代理机构:'||PROXY as A,
        '发布时间:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=51
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '债券信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '债券名称:'||to_clob(BONDNAME)||';   债券代码:'||BONDNUM||';    债券类型 :'||BONDTYPE||';   计息方式 :'||CALINTERESTTYPE||'; 债项评级:'||DEBTRATING||'; 信用评级机构:'||CREDITRATINGGOV
        ||'; 托管机构:'||ESCROWAGENT||'; 行权类型:'||EXERIGHTTYPE||'; 票面利率(%):'||FACEINTERESTRATE||'; 面值:'||FACEVALUE||';  流通范围: '||FLOWRANGE||'; 发行价格(元):'||ISSUEDPRICE||'; 付息频率:'||PAYINTERESTHZ
        ||'; 实际发行量(亿) :'||REALISSUEDQUANTITY||'; 发行人:'||PUBLISHERNAME||'; 债券起息日'
        as A,
        '上市交易日:'||TO_CHAR(BONDTRADETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 行权日期:'||TO_CHAR(EXERIGHTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债劵到期日:'||TO_CHAR(PUBLISHEXPIRETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债劵发行日:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 债券起息日:'||TO_CHAR(STARTCALINTERESTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        BIDURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=52
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '购地信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '宗地位置:'||To_clob(LOCATION)||';   供地总面积(公顷):'||TOTALAREA||';    成交价款（万元） :'||DEALPRICE||';   供应方式 :'||SUPPLYWAY||'; 土地用途:'||PURPOSE||'; 受让人:'||ASSIGNEE
        ||'; 上级公司:'||PARENTCOMPANY
        as A,
        '约定竣工时间:'||TO_CHAR(ENDTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        LINKURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=53
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '税务评级' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人识别号:'||to_clob(NUMBER2)||';   纳税等级:'||GRADE||';    类别:'||CASE TYPE WHEN '0' THEN '国税' ELSE '地税' END||';   评价单位 :'||EVALDEPARTMENT
        as A,
        '年份:'||YEAR
        as B,
        LINKURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=55
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '抽查检查' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '结果:'||to_clob(CHECKRESULT)||';   类型:'||CHECKTYPE||';    实施机关:'||CHECKORG
        as A,
        '日期:'||TO_CHAR(CHECKDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=56
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '产品信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '产品名:'||NAME||';   描述:'||to_clob(BRIEF)||';    产品分类:'||TYPE||'; 领域'||CLASSES
        as A,
        NULL
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=57
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL

        SELECT
        TYPEA,
        '行政许可【工商局】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||NUMBER2||';   许可证名称:'||NAME||';    等级:'||GRADE||'; 范围'||to_clob(SCOPE)||'; 证书状态 '||STATE||'; 发证机关'||DEPARTMENT
        as A,
        '起始日期:'||FROMDATE||'; 到期日期'||TODATE
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=511
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '行政许可【信用中国】' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||NUMBER2||';   内容许可:'||to_clob(CONTENT)||';    许可机关:'||DEPARTMENT||'; 审核类型'||AUDITYPE||'; 证书状态 '||STATE||'; 许可机关'||DEPARTMENT
        as A,
        '许可决定日期:'||TO_CHAR(DECISIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||'; 许可截止日期'||TO_CHAR(ENDDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=512
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '商标信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '国际分类code:'||TMCLASS||';   商标名称:'||to_clob(TMNAME)||';    状态:'||STATUS||';  国际分类'||INTCLS||'; 商标状态 '||CATEGORY||'; 商标图片'||TMPIC||'; 注册号'||REGNO||';  申请人'||APPLICANTCN
        as A,
        '申请日期:'||TO_CHAR(APPDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=61
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '专利信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '专利名称:'||PATENTNAME||';   专利类型:'||PATENTTYPE||';    摘要:'||to_clob(ABSTRACTS)||';  申请号/专利号'||PATENTNUM||';  全部分类号 '||ALLCATNUM||'; 主分类号'||MAINCATNUM||'; 发明人'||INVENTOR||';  代理人'||AGENT||'; 代理机构'||AGENCY||'; 申请人 '||APPLICANTNAME
        as A,
        '申请日:'||TO_CHAR(APPLICATIONTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 公开公告日:'||TO_CHAR(PUBDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        IMGURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=62
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '软件著作权' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '软件名称:'||to_clob(FULLNAME)||';   版本号:'||VERSION||';    著作权人(国籍):'||AUTHORNATIONALITY||';  登记号'||REGNUM||';  分类号 '||CATNUM
        as A,
        '首次发表时间:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 登记时间:'||TO_CHAR(REGTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        IMGURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=63
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '作品著作权' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '作品名称:'||to_clob(FULLNAME)||';   作品类别:'||TYPE||';    著作权人名称:'||AUTHORNATIONALITY||';  登记号'||REGNUM
        as A,
        '登记日期:'||TO_CHAR(REGTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 创作完成日期:'||TO_CHAR(FINISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=64
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '送达公告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '公告名称:'||TITLE||';   法院名称:'||COURT||';    详情:'||to_clob(CONTENT)
        as A,
        '发布日期:'||TO_CHAR(STARTDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=79
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '立案信息' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 案号:'||CASENO||';    案件类型:'||CASETYPE||';    案件状态:'||to_clob(CASESTATUS)||'; 法院:'||COURT||';  承办部门:'||DEPARTMENT||';  承办法官:'||JUDGE||'; 原告:'||PLAINTIFF||'; 被告:'||DEFENDANT||';  第三人:'||THIRD
        as A,
        '立案日期:'||TO_CHAR(FILINGDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 开庭日期:'||TO_CHAR(STARTTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        ';  结束日期'||TO_CHAR(CLOSEDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=80
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '税收违法' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '纳税人名称:'||TAXPAYERNAME||';    违法情况:'||to_clob(CASEINFO)||';    案件性质:'||CASETYPE||';  纳税人识别号:'||TAXPAYERNUMBER||';  所属税务机关:'||DEPARTMENT||';  组织机构代码:'||TAXPAYERCODE
        as A,
        NULL
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE  TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=81
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '简易注销' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 统一社会信用代码:'||CREDITCODE||';    登记机关:'||to_clob(REGAUTHORITY)||';    公告期:'||ANNOUNCEMENTTERM
        as A,
        NULL
        as B,
        INVESTORCOMMITMENTDOWNLOADURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=82
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '环保处罚' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        ' 处罚结果:'||EXECUTION||';    处罚单位:'||PUNISHDEPARTMENT||';    处罚事由:'||to_clob(PUNISHREASON)||'; 处罚依据:'||to_clob(PUNISHBASIS)||';  违反法律:'||to_clob(LAWBREAKING)||';  决定文书号:'||PUNISHNUMBER
        as A,
        '处罚日期:'||TO_CHAR(PUBLISHTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=83
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '公示催告' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '票据号:'||BILLNUM||';    票据类型:'||BILLTYPE||';    票面金额:'||BILLAMT||'; 持票人:'||OWNERCOMPANYNAME||';   出票人:'||DRAWCOMPANYNAME||';   付款银行:'||PAYCOMPANYNAME||'; 公告内容:'||to_clob(INFODETAIL)
        as A,
        '出票日:'||TO_CHAR(BILLBEGINDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'到期日 :'||TO_CHAR(BILLENDDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'公告日期:'||TO_CHAR(PUBLISHDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=84
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '土地抵押' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '抵押面积(公顷):'||MORTGAGEAREA||';    票据类型:'||BILLTYPE||';    票面金额:'||BILLAMT||'; 持票人:'||OWNERCOMPANYNAME||';   出票人:'||DRAWCOMPANYNAME||';   付款银行:'||PAYCOMPANYNAME||'; 公告内容:'||to_clob(INFODETAIL)
        as A,
        '出票日:'||TO_CHAR(BILLBEGINDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'到期日 :'||TO_CHAR(BILLENDDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        ||'公告日期:'||TO_CHAR(PUBLISHDT/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=85
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '土地转让' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '土地面积(公顷):'||AREA||';    土地级别:'||LEVEL3||';    原土地使用权人:'||USERCHANGEPRE||'; 转让方式:'||to_clob(MERCHANDISETYPE)||';    土地使用权类型:'||USETYPE||';   土地使用年限:'||PAYCOMPANYNAME||'; 转让价格(万元）:'||MERCHANDISPRICE||'; 现土地使用权人:'||USERCHANGENOW||';  土地用途:'||USEFUL||'; 土地利用状况:'||SITUATION
        as A,
        '成交日期:'||TO_CHAR(MERCHANDISETIMECLEAN/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=86
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>


        UNION ALL
        SELECT
        TYPEA,
        '地块公示' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '项目名称'||PROJECTNAME||'土地面积(公顷):'||LANDAREA||';    地块位置:'||LANDLOCATION||';     受让单位:'||LANDUSERIGHTPERSON||'; 土地用途:'||LANDUSEFULNESS||';    公示期:'||PUBLICANNOUNCEMENTPERIOD||';   意见反馈方式:'||to_clob(FEEDBACKMETHOD)||';  发布机关 :'||PUBLICATIONORGANIZE
        as A,
        '发布日期:'||TO_CHAR(PUBLICATIONDATE/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=87
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '电信许可' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '许可证号:'||LICENSENUMBER||' 业务及其覆盖范围:'||to_clob(BUSINESSSCOPE)||';    是否有效:'||ISAVAILABLE
        as A,
        null
        as B,
        NULL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=88
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '限制消费令' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '姓名:'||XNAME||' 企业信息:'||to_clob(QYINFO)||';    是否有效:'||ISAVAILABLE
        as A,
        '立案日期:'||TO_CHAR(CASECREATETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=89
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '终本案件' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '案号:'||CASECODE||' 身份证号码/组织机构代码:'||PARTYCARDNUM||';     执行法院:'||to_clob(EXECCOURTNAME)||';  执行标的:'||EXECMONEY||';  未履行金额:'||NOEXECMONEY
        as A,
        '终本日期:'||TO_CHAR(CASEFINALTIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')||
        '; 立案日期:'||TO_CHAR(CASECREATETIME/(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=90
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '大股东变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '现大股东名称:'||to_clob(BIGSHAREHOLDER)||' 原大股东名称:'||BIGSHAREHOLDERBEFORE
        as A,
        null
        as B,
        null as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE  TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=116
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '股权变更' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '股东名称:'||to_clob(SHAREHOLDERNAME)||'; 原出资比例:'||PERCENTBEFORE||';     现出资比例:'||PERCENT||';  原认缴出资额:'||CAPITALBEFORE||';  现认缴出资额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=122
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '退出对外投资' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '被投资企业名称:'||to_clob(NAME)||'; 投资数额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=120
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '新增对外投资' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '被投资企业名称:'||to_clob(NAME)||'; 投资数额:'||CAPITAL
        as A,
        null
        as B,
        ORIURL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=121
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        UNION ALL
        SELECT
        TYPEA,
        '新闻舆情' as TYPENAME,
        COMPANYGID,
        COMPANYNAME,
        RISKLEVEL,
        TO_CHAR(UPDATETIME,'YYYY-MM-DD') AS UPDATETIME,
        '新闻标题:'||TITLE||';    来源:'||to_clob(SOURCE)
        as A,
        NULL as B,
        URL as URL
        FROM
        BIUSER.ODS_TYC_PUSHSTRUCT
        WHERE TO_CHAR(UPDATETIME,'YYYY-MM-DD')     BETWEEN #{startDate} AND #{endDate}
        and TYPEA=3001
        and COMPANYNAME in (SELECT DISTINCT ENTNAME FROM LOG_TYC_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY=#{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and RISKLEVEL in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and COMPANYNAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>

        )
        SELECT COUNT(1) as co
        FROM (
        SELECT * FROM ds1
        where 1=1 <if test="eventType != null and eventType.size > 0">
        and TYPENAME in
        <foreach collection="eventType" index="index" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </if>
        ORDER BY UPDATETIME DESC
        ) A

    </select>


    <resultMap id="getZCXCompayNameListResultMap" type="java.lang.String">
        <result column="entName" jdbcType="VARCHAR" property="entName" />
    </resultMap>
    <select id="getZCXCompayNameList" resultType="java.lang.String">
      SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY= #{userName}
    </select>

    <resultMap id="getPlatformNewsResultMap" type="com.fanruan.platform.bean.PlatformNews">
        <result column="pushType" jdbcType="VARCHAR" property="pushType" />
        <result column="promptinfo" jdbcType="VARCHAR" property="promptinfo" />
        <result column="userName" jdbcType="VARCHAR" property="userName" />
        <result column="updateTime" jdbcType="VARCHAR" property="updateTime" />
    </resultMap>
    <select id="getPlatformNews" resultType="com.fanruan.platform.bean.PlatformNews">
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.*
        FROM (
        SELECT
        PUSH_TYPE,
        PROMPTINFO,
        USER_NAME,
        TO_CHAR(PUSH_TIME,'YYYY-MM-DD') AS UPDATETIME
        FROM
        BIUSER.INPUT_PUSH
        WHERE TO_CHAR(PUSH_TIME,'YYYY-MM-DD') BETWEEN #{startDate} AND #{endDate}
        and USER_NAME = #{userName}
        and PUSH_TYPE != '企业信息变动'
        order by UPDATETIME DESC,PUSH_TYPE DESC
        )N
        )M
        where 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getPlatformNewsCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

    <select id="getPlatformNewsCount" resultType="java.lang.Integer">
         SELECT COUNT(*) as co FROM (
            SELECT
            PUSH_TYPE,
            PROMPTINFO,
            USER_NAME,
            TO_CHAR(PUSH_TIME,'YYYY-MM-DD') AS UPDATETIME
            FROM
            BIUSER.INPUT_PUSH
            WHERE TO_CHAR(PUSH_TIME,'YYYY-MM-DD') BETWEEN #{startDate} AND #{endDate}
            and USER_NAME = #{userName}
            and PUSH_TYPE != '企业信息变动'
            order by UPDATETIME DESC,PUSH_TYPE DESC
         )
    </select>


    <resultMap id="getRiskMorningPostResultMap" type="com.fanruan.platform.bean.RiskMorningPost">
        <result column="enterpriseName" jdbcType="VARCHAR" property="enterpriseName" />
        <result column="entType" jdbcType="VARCHAR" property="entType" />
        <result column="levelType" jdbcType="VARCHAR" property="levelType" />
        <result column="typeName" jdbcType="VARCHAR" property="typeName" />
        <result column="description" jdbcType="VARCHAR" property="description" />
        <result column="UD" jdbcType="VARCHAR" property="UD" />
    </resultMap>
    <select id="getRiskMorningPost" resultType="com.fanruan.platform.bean.RiskMorningPost">
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.*
        FROM (
        SELECT
        TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD hh24:mi:ss'), 'YYYY-MM-DD') as cd,
        case R.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,
        case R.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,
        R.DESCRIPTION,
        R.TYPE_NAME,
        R.CREDIT_CODE,
        TO_CHAR(R.UPDATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD hh24:mi:ss'), 'YYYY-MM-DD') as ud,
        R.ENTERPRISE_NAME
        FROM
        BIUSER.ODS_ZCX_RISKEVENT R
        WHERE TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD hh24:mi:ss'), 'YYYY-MM-DD') BETWEEN #{startDate} AND #{endDate}
        and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY= #{userName})
        <if test="riskleve != null and riskleve.size > 0">
            and R.LEVEL1 in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and R.ENTERPRISE_NAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        ORDER BY cd desc,R.ENTERPRISE_NAME
        )N
        )M
        where 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>
<!--    <select id="getRiskMorningPost" resultType="com.fanruan.platform.bean.RiskMorningPost">-->
<!--        SELECT M.* FROM (-->
<!--        SELECT ROWNUM AS rowno,N.*-->
<!--        FROM (-->
<!--            SELECT-->
<!--            TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as cd,-->
<!--            case R.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,-->
<!--            case R.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,-->
<!--            R.DESCRIPTION,-->
<!--            R.TYPE_NAME,-->
<!--            R.CREDIT_CODE,-->
<!--            TO_CHAR(R.UPDATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as ud,-->
<!--            R.ENTERPRISE_NAME-->
<!--            FROM-->
<!--            BIUSER.ODS_ZCX_RISKEVENT R-->
<!--            WHERE TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') BETWEEN #{startDate} AND #{endDate}-->
<!--            and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY= #{userName})-->
<!--            <if test="riskleve != null and riskleve.size > 0">-->
<!--                and R.LEVEL1 in-->
<!--                <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">-->
<!--                    #{item}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="companyName != null and companyName.size > 0">-->
<!--                and R.ENTERPRISE_NAME in-->
<!--                <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">-->
<!--                    #{item}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            ORDER BY cd desc,R.ENTERPRISE_NAME-->
<!--        )N-->
<!--        )M-->
<!--        where 1 = 1-->
<!--        AND rowno &lt;= #{pageIndex} * #{pageSize}-->
<!--        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}-->
<!--    </select>-->

    <resultMap id="getRiskMorningPostCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

    <select id="getRiskMorningPostCount" resultType="java.lang.Integer">
         SELECT COUNT(*) as co FROM (
            SELECT
            TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') as cd,
            case R.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,
            case R.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,
            R.DESCRIPTION,
            R.TYPE_NAME,
            R.CREDIT_CODE,
            TO_CHAR(R.UPDATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') as ud,
            R.ENTERPRISE_NAME
            FROM
            BIUSER.ODS_ZCX_RISKEVENT R
            WHERE TO_CHAR(R.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') BETWEEN #{startDate} AND #{endDate}
            and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY= #{userName})
            <if test="riskleve != null and riskleve.size > 0">
                and R.LEVEL1 in
                <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>
            <if test="companyName != null and companyName.size > 0">
                and R.ENTERPRISE_NAME in
                <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>
            ORDER BY cd desc,R.ENTERPRISE_NAME
         )
    </select>


    <resultMap id="getMorningNewsResultMap" type="com.fanruan.platform.bean.MorningNews">
        <result column="enterpriseName" jdbcType="VARCHAR" property="enterpriseName" />
        <result column="entType" jdbcType="VARCHAR" property="entType" />
        <result column="levelType" jdbcType="VARCHAR" property="levelType" />
        <result column="description" jdbcType="VARCHAR" property="description" />
        <result column="newsType" jdbcType="VARCHAR" property="newsType" />
        <result column="title" jdbcType="VARCHAR" property="title" />
        <result column="newstags" jdbcType="VARCHAR" property="newstags" />
        <result column="URL" jdbcType="VARCHAR" property="URL" />
        <result column="CD" jdbcType="VARCHAR" property="CD" />
    </resultMap>
<!--    <select id="getMorningNews" resultType="com.fanruan.platform.bean.MorningNews">-->
<!--        SELECT M.* FROM (-->
<!--        SELECT ROWNUM AS rowno,N.*-->
<!--        FROM (-->
<!--            SELECT-->
<!--            TO_CHAR(N.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as cd,-->
<!--            case N.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,-->
<!--            case N.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,-->
<!--            N.DESCRIPTION,-->
<!--            N.TYPE_NAME,-->
<!--            N.CREDIT_CODE,-->
<!--            TO_CHAR(N.UPDATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as ud,-->
<!--            N.ENTERPRISE_NAME,-->
<!--            N.NEWSTAGS,-->
<!--            N.TITLE,-->
<!--            N.NEWSTYPE,-->
<!--            N.URL,-->
<!--            TO_CHAR(N.PUBLISHTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD') as pd-->

<!--            FROM-->
<!--            BIUSER.ODS_ZCX_NEWSPUBOPINION N-->
<!--            WHERE TO_CHAR(N.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01', 'YYYY-MM-DD'), 'YYYY-MM-DD')  BETWEEN #{startDate} AND #{endDate}-->
<!--            <if test="riskleve != null and riskleve.size > 0">-->
<!--                and N.LEVEL1 in-->
<!--                <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">-->
<!--                    #{item}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="newsEmotion != null and newsEmotion.size > 0">-->
<!--                and N.DESCRIPTION in-->
<!--                <foreach collection="newsEmotion" index="index" item="item" open="(" separator="," close=")">-->
<!--                    #{item}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="companyName != null and companyName.size > 0">-->
<!--                and N.ENTERPRISE_NAME in-->
<!--                <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">-->
<!--                    #{item}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY = #{userName} )-->
<!--            ORDER BY pd desc,N.ENTERPRISE_NAME-->
<!--        )N-->
<!--        )M-->
<!--        where 1 = 1-->
<!--        AND rowno &lt;= #{pageIndex} * #{pageSize}-->
<!--        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}-->
<!--    </select>-->
    <select id="getMorningNews" resultType="com.fanruan.platform.bean.MorningNews">
        SELECT M.* FROM (
        SELECT ROWNUM AS rowno,N.*
        FROM (
        SELECT
        TO_CHAR(TO_DATE( '1970-01-01 08:00:00', 'yyyy-mm-dd hh24:mi:ss')+TO_NUMBER(N.CREATE_TIME)/(1000*60*60*24),'yyyy-mm-dd') as cd,
        case N.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,
        case N.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,
        N.DESCRIPTION,
        N.TYPE_NAME,
        N.CREDIT_CODE,
        TO_CHAR(TO_DATE( '1970-01-01 08:00:00', 'yyyy-mm-dd hh24:mi:ss')+TO_NUMBER(N.UPDATE_TIME)/(1000*60*60*24),'yyyy-mm-dd') as ud,
        N.ENTERPRISE_NAME,
        N.NEWSTAGS,
        N.TITLE,
        N.NEWSTYPE,
        N.URL,
        TO_CHAR(TO_DATE( '1970-01-01 08:00:00', 'yyyy-mm-dd hh24:mi:ss')+TO_NUMBER(N.PUBLISHTIME)/(1000*60*60*24),'yyyy-mm-dd') as pd

        FROM
        BIUSER.ODS_ZCX_NEWSPUBOPINION N
        WHERE TO_CHAR(TO_DATE( '1970-01-01 08:00:00', 'yyyy-mm-dd hh24:mi:ss')+TO_NUMBER(N.CREATE_TIME)/(1000*60*60*24),'yyyy-mm-dd')  BETWEEN #{startDate} AND #{endDate}
        <if test="riskleve != null and riskleve.size > 0">
            and N.LEVEL1 in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="newsEmotion != null and newsEmotion.size > 0">
            and N.DESCRIPTION in
            <foreach collection="newsEmotion" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and N.ENTERPRISE_NAME in
            <foreach collection="companyName" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY = #{userName} )
        ORDER BY cd desc,N.ENTERPRISE_NAME
        )N
        )M
        where 1 = 1
        AND rowno &lt;= #{pageIndex} * #{pageSize}
        AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <resultMap id="getMorningNewsCountResultMap" type="java.lang.Integer">
        <result column="co" jdbcType="VARCHAR" property="co" />
    </resultMap>

    <select id="getMorningNewsCount" resultType="java.lang.Integer">
        SELECT COUNT(*) as co FROM (
        SELECT
        TO_CHAR(N.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD  HH24:MI:SS'), 'YYYY-MM-DD') as cd,
        case N.LEVEL1 when '0' then '一般' when '1' then '重大' when '2' then '警示' end as LEVEL_TYPE,
        case N.ENT_TYPE when '0' then '非城投企业' when '1' then '城投企业' end as  ENT_TYPE,
        N.DESCRIPTION,
        N.TYPE_NAME,
        N.CREDIT_CODE,
        TO_CHAR(N.UPDATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') as ud,
        N.ENTERPRISE_NAME,
        N.NEWSTAGS,
        N.TITLE,
        N.NEWSTYPE,
        N.URL,
        TO_CHAR(N.PUBLISHTIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') as pd

        FROM
        BIUSER.ODS_ZCX_NEWSPUBOPINION N
        WHERE TO_CHAR(N.CREATE_TIME /(1000 * 60 * 60 * 24)+ TO_DATE('1970-01-01 08:00:00', 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD')  BETWEEN #{startDate} AND #{endDate}
        <if test="riskleve != null and riskleve.size > 0">
            and N.LEVEL1 in
            <foreach collection="riskleve" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="newsEmotion != null and newsEmotion.size > 0">
            and N.DESCRIPTION in
            <foreach collection="newsEmotion" index="index" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="companyName != null and companyName.size > 0">
            and N.ENTERPRISE_NAME in
            <foreach collection="companyName" index="index" item="item"  open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        and ENTERPRISE_NAME in (SELECT DISTINCT ENTNAME FROM LOG_ZCX_CONCERN WHERE CONCERN_FLAG=1 AND UPDATEBY = #{userName} )
        ORDER BY pd desc,N.ENTERPRISE_NAME
        )
    </select>
<!--jina-->
    <insert id="insertReportApply" parameterType="java.lang.String" useGeneratedKeys="false" >
        insert into INPUT_PUSH(ID,USER_NAME,PUSH_FLAG,PUSH_TIME,RESULT_TYPE,RESULT,PROMPTINFO,
                               OA_FLAG,PUSH_TYPE,TYC_UPDATETIME,URL) values

               (lower(sys_guid()), #{item}, '0', sysdate, NULL,NULL,
               '您有新的信保报告需要审核，请及时查看',NULL,'信保报告审核',NULL,NULL)

    </insert>

    <select id="getReportApplyUserNameList" parameterType="java.lang.String" resultType="java.lang.String">
       SELECT USERNAME
             FROM CREDIT_USER C
             WHERE C.ROLE_NAME = '审核专员'
			 AND C.COMPANY_NAME =  (
									SELECT COMPANYNAME
									FROM (
									SELECT COMPANYCODE,COMPANYNAME,SUBCOMPANYCODE,SUBCOMPANYNAME,SHORTNAME
									FROM DIM_ORG
									WHERE 1=1

									) COMP
									WHERE SUBCOMPANYNAME =
									    (SELECT C.COMPANY_NAME
										FROM CREDIT_USER C
										WHERE C.USERNAME=#{userName})
														)
									UNION
                                    SELECT 'admin' AS USERNAME
                                    FROM DUAL
                                    WHERE 'admin' = #{userName}

    </select>

    <select id="getSecondaryDepartmentByLoginName" parameterType="java.lang.String" resultType="java.lang.String">

    SELECT COMPANYNAME FROM VIEW_ORG
    WHERE COMPANYNAME IN
    (
    select COMPANYNAME from VIEW_ORG WHERE 1 = 1


        and (SUBCOMPANYNAME =
    (SELECT U.COMPANY_NAME
    FROM CREDIT_USER U
    WHERE USERNAME = #{loginName})
    )

    )
    AND COMPANYNAME= SUBCOMPANYNAME
    AND TP in ('1','2')

    </select>
    <select id="reportbuyerNoIsExist" parameterType="java.lang.String" resultType="java.lang.Integer">
    select count(*) from
    (SELECT L.REPORTBUYERNO
    FROM LOG_ZXB_APPLY L
    WHERE L.UPDATETIME >=add_months(sysdate,-6)  and L.REPORTBUYERNO =  #{reportbuyerNo})
    </select>


    <select id="getOrderState" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT ORDERSTATE FROM (
            SELECT ORDERSTATE FROM ODS_ZXB_REPORTAPPROVE WHERE CORPSERIALNO = #{corpSerialNo} ORDER BY UPDATETIME DESC)
        WHERE ROWNUM = 1
    </select>

    <select id="getNoticeSerialNo" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT NOTICESERIALNO FROM (
                                   SELECT NOTICESERIALNO FROM ODS_ZXB_REPORTAPPROVE WHERE CORPSERIALNO = #{corpSerialNo} ORDER BY UPDATETIME DESC)
        WHERE ROWNUM = 1
    </select>

    <select id="companyExist" parameterType="com.fanruan.platform.bean.Company" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM CREDIT_COMPANY WHERE ID = #{id} AND UPDATE_TIME &lt; TRUNC(SYSDATE, 'dd')
    </select>

    <update id="updateCompany" parameterType="com.fanruan.platform.bean.Company">
        UPDATE CREDIT_COMPANY SET COMPANY_NAME = #{companyName}, UPDATE_TIME = #{updateTime}, BUILD_DATE = #{buildDate}, CREDIT_CODE = #{creditCode}
                                , OPER_NAME = #{operName}, REGIST_CAPI = #{registCapi}, REG_NO = #{regNo}
                                  WHERE ID = #{id}
    </update>

<!--        <resultMap id="getBlackListInHomePageResultMap" type="com.fanruan.platform.bean.BlackListDetailResultList">-->
<!--            <result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />-->
<!--            <result column="BE_RISKY_ASSETS_DATE" jdbcType="VARCHAR" property="beRiskyAssetsDate" />-->
<!--            <result column="AMOUNT_OF_MARK" jdbcType="VARCHAR" property="amountOfMark" />-->
<!--            <result column="ORG_NO" jdbcType="VARCHAR" property="orgNo" />-->
<!--        </resultMap>-->
<!--        <select id="getBlackListInHomePage" resultType="com.fanruan.platform.bean.BlackListDetailResultList">-->
<!--            SELECT * FROM(-->
<!--                SELECT ROWNUM AS r,x.* FROM(-->
<!--                    SELECT * FROM V_CREDIT_BLACKLIST-->
<!--                    <if test="sortCriteria != null and sortCriteria == 'startDate'">-->
<!--                        ORDER BY BE_RISKY_ASSETS_DATE DESC-->
<!--                    </if>-->
<!--                    <if test="sortCriteria != null and sortCriteria == 'amount'">-->
<!--                        ORDER BY AMOUNT_OF_MARK DESC-->
<!--                    </if>-->
<!--                             ) x ) Y-->
<!--                WHERE 1 = 1-->
<!--                  AND r &lt;= #{pageIndex, jdbcType=INTEGER} * #{pageSize, jdbcType=INTEGER}-->
<!--                  AND r  &gt; (#{pageIndex, jdbcType=INTEGER}-1) * #{pageSize, jdbcType=INTEGER}-->
<!--        </select>-->

<!--        <select id="getBlackListInHomePageCount" resultType="java.lang.Integer">-->
<!--            select count(*) from (-->
<!--                                     select * from V_CREDIT_BLACKLIST-->
<!--                                     )-->
<!--        </select>-->


    <resultMap id="getBlackListResultMap" type="com.fanruan.platform.bean.BlackListDetailResultList">
        <result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />
        <result column="BE_RISKY_ASSETS_DATE" jdbcType="VARCHAR" property="beRiskyAssetsDate" />
        <result column="AMOUNT_OF_MARK" jdbcType="VARCHAR" property="amountOfMark" />
        <result column="ORG_NO" jdbcType="VARCHAR" property="orgNo" />
        <result column="TYC_COMPANY_ID" jdbcType="VARCHAR" property="tycCompanyId" />
    </resultMap>
    <select id="getBlackList" resultType="com.fanruan.platform.bean.BlackListDetailResultList">
        SELECT * FROM(
            SELECT ROWNUM AS r,A.* FROM(
                SELECT * FROM V_CREDIT_BLACKLIST
                <if test="sortCriteria != null and sortCriteria == 'startDate'">
                    ORDER BY BE_RISKY_ASSETS_DATE DESC
                </if>
                <if test="sortCriteria != null and sortCriteria == 'amount'">
                    ORDER BY AMOUNT_OF_MARK DESC
                </if>
            ) A
        )
        WHERE 1 = 1
        <if test=" pageIndex != null and pageIndex != '' and pageSize != null and pageSize != ''">
            AND r &lt;= #{pageIndex, jdbcType=INTEGER} * #{pageSize, jdbcType=INTEGER}
            AND r  &gt; (#{pageIndex, jdbcType=INTEGER}-1) * #{pageSize, jdbcType=INTEGER}
        </if>

    </select>

    <select id="getBlackListTotalCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM (
                                 SELECT * FROM V_CREDIT_BLACKLIST
                             )
    </select>

    <resultMap id="getGreyListResultMap" type="com.fanruan.platform.bean.BlackListDetailResultList">
        <result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />
        <result column="BE_RISKY_ASSETS_DATE" jdbcType="VARCHAR" property="beRiskyAssetsDate" />
        <result column="AMOUNT_OF_MARK" jdbcType="VARCHAR" property="amountOfMark" />
        <result column="ORG_NO" jdbcType="VARCHAR" property="orgNo" />
        <result column="TYC_COMPANY_ID" jdbcType="VARCHAR" property="tycCompanyId" />
    </resultMap>
    <select id="getGreyList" resultType="com.fanruan.platform.bean.BlackListDetailResultList">
        SELECT * FROM(
            SELECT ROWNUM AS r,A.* FROM(
                SELECT * FROM V_CREDIT_GREYLIST
                ORDER BY BE_RISKY_ASSETS_DATE DESC
            ) A
        )
        WHERE 1 = 1
        <if test=" pageIndex != null and pageIndex != '' and pageSize != null and pageSize != ''">
            AND r &lt;= #{pageIndex, jdbcType=INTEGER} * #{pageSize, jdbcType=INTEGER}
            AND r  &gt; (#{pageIndex, jdbcType=INTEGER}-1) * #{pageSize, jdbcType=INTEGER}
        </if>

    </select>

    <select id="getGreyListTotalCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM (
                                 SELECT * FROM V_CREDIT_GREYLIST
                             )
    </select>

    <select id="getXBPDFFileName" resultType="java.lang.String">
        SELECT REPORTNAME FROM (
            SELECT ROWNUM AS r, t.*  FROM (
                SELECT DISTINCT
                    A.REPORTBUYERNO,--信保代码
                    P.NOTICESERIALNO || '.pdf' AS reportName,
                    p.UPDATETIME
                FROM
                    ODS_ZXB_PDF P
                        INNER JOIN ( SELECT NOTICESERIALNO, MAX( UPDATETIME ) MAXTIME FROM ODS_ZXB_PDF GROUP BY NOTICESERIALNO ) D ON D.MAXTIME = P.UPDATETIME
                        INNER JOIN ODS_ZXB_REPORTAPPROVE R ON R.NOTICESERIALNO = P.NOTICESERIALNO
                        AND ORDERSTATE = '0'
                        INNER JOIN LOG_ZXB_APPLY A ON R.CORPSERIALNO = A.CORPSERIALNO_IMPORT
                        LEFT JOIN ( SELECT BUYERENGNAME, BUYERCHNNAME, SINOSUREBUYERNO, MAX( UPDATETIME ) MAXTIME FROM ODS_ZXB_RATINGINFO GROUP BY BUYERENGNAME, BUYERCHNNAME, SINOSUREBUYERNO ) I ON I.BUYERENGNAME = A.REPORTCORPENGNAME
                        OR I.BUYERCHNNAME = A.REPORTCORPCHNNAME
                        OR I.SINOSUREBUYERNO = A.REPORTBUYERNO
                ORDER BY UPDATETIME DESC
            ) t
            WHERE 1 = 1
            AND (t.REPORTBUYERNO = #{reportBuyerNo, jdbcType=VARCHAR})
            ORDER BY REPORTBUYERNO DESC
        ) WHERE ROWNUM = 1
    </select>

    <select id="getXBPDFFileUpdateTime" resultType="java.lang.String">
        SELECT TO_CHAR(UPDATETIME, 'YYYY-MM-DD') AS UPDATETIME FROM (
            SELECT ROWNUM AS r, t.*  FROM (
                  SELECT DISTINCT
                      A.REPORTBUYERNO,--信保代码
                      P.NOTICESERIALNO || '.pdf' AS reportName,
                      p.UPDATETIME
                  FROM
                      ODS_ZXB_PDF P
                          INNER JOIN ( SELECT NOTICESERIALNO, MAX( UPDATETIME ) MAXTIME FROM ODS_ZXB_PDF GROUP BY NOTICESERIALNO ) D ON D.MAXTIME = P.UPDATETIME
                          INNER JOIN ODS_ZXB_REPORTAPPROVE R ON R.NOTICESERIALNO = P.NOTICESERIALNO
                          AND ORDERSTATE = '0'
                          INNER JOIN LOG_ZXB_APPLY A ON R.CORPSERIALNO = A.CORPSERIALNO_IMPORT
                          LEFT JOIN ( SELECT BUYERENGNAME, BUYERCHNNAME, SINOSUREBUYERNO, MAX( UPDATETIME ) MAXTIME FROM ODS_ZXB_RATINGINFO GROUP BY BUYERENGNAME, BUYERCHNNAME, SINOSUREBUYERNO ) I ON I.BUYERENGNAME = A.REPORTCORPENGNAME
                          OR I.BUYERCHNNAME = A.REPORTCORPCHNNAME
                          OR I.SINOSUREBUYERNO = A.REPORTBUYERNO
                  ORDER BY UPDATETIME DESC
              ) t
            WHERE 1 = 1
              AND (t.REPORTBUYERNO = #{reportBuyerNo, jdbcType=VARCHAR})
            ORDER BY REPORTBUYERNO DESC
        ) WHERE ROWNUM = 1
    </select>

    <select id="getUserId" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT USER_ID FROM CREDIT_USER WHERE USERNAME = #{userName}
    </select>

    <select id="getApplyInfo" resultType="com.fanruan.platform.bean.InputPush">
        SELECT LOWER (SYS_GUID()) AS ID,
               C.USERNAME,
               '0' AS PUSH_FLAG,
               '您有一条新的信保报告待审核，请尽快处理。申请人：'||B.NAME AS promptinfo,
               '信保报告申请' AS PUSH_TYPE,
               SYSDATE AS UPDATETIME
        FROM CREDIT_USER C
                 LEFT JOIN CREDIT_USER B
                           ON 1=1
                               AND  B.USERNAME = #{username}
        WHERE C.ROLE_NAME = '信保审核专员'
          AND C.COMPANY_NAME = (
            SELECT COMPANYNAME
            FROM (
                     SELECT COMPANYCODE,COMPANYNAME,SUBCOMPANYCODE,SUBCOMPANYNAME,SHORTNAME
                     FROM DIM_ORG
                     WHERE 1=1

                 ) COMP
            WHERE SUBCOMPANYNAME =
                  (SELECT C.COMPANY_NAME
                   FROM CREDIT_USER C
                   WHERE C.USERNAME= #{username})
        )
    </select>

    <insert id="insertZXBApplyInfo4ETL" parameterType="com.fanruan.platform.bean.TianYanChaJson">
        insert into INPUT_PUSH(ID,USER_NAME,PUSH_FLAG,PROMPTINFO,PUSH_TYPE,UPDATETIME) VALUES (lower(sys_guid())
                                                                                            ,#{userName}
                                                                                            ,#{pushFlag}
                                                                                            ,#{promptinfo}
                                                                                            ,#{pushType}
                                                                                            ,#{updateTime})
    </insert>

    <insert id="insertPAFCUser" parameterType="com.fanruan.platform.bean.PAFCUser">
        INSERT INTO PAFC_INPUT_USER (USERNAME,EMAIL,COMPANY_CODE) VALUES (#{userName}
                                                                        ,#{email}
                                                                        ,#{companyCode})
    </insert>

    <update id="updatePAFCUserById" parameterType="com.fanruan.platform.bean.PAFCUser">
        UPDATE PAFC_INPUT_USER SET USERNAME = #{userName} , EMAIL = #{email} WHERE ID = #{id}
    </update>

    <delete id="deletePAFCUserById" parameterType="com.fanruan.platform.bean.PAFCUser">
        DELETE FROM PAFC_INPUT_USER WHERE ID = #{id}
    </delete>

<!--    <insert id="insertPAFCDistributeInfo" parameterType="com.fanruan.platform.bean.PAFCUser">-->
<!--        INSERT INTO PAFC_INPUT_DISTRIBUTE (COMPANY_CODE, USERNAME, VERSION_NO, CREATE_DATE) VALUES-->
<!--                                        (#{companyCode},  #{userName}, #{versionNo}, sysdate)-->
<!--    </insert>-->


    <update id="updatePAFCVersion" parameterType="com.fanruan.platform.bean.PAFCVersion">
        UPDATE PAFC_INPUT_VERSION SET VERSION_NO = #{versionNo}, INTERFACE_TOTAL_POINTS = #{interfaceTotalPoints}
                                    , ATTENTION_TOTAL_POINTS = #{attentionTotalPoints}, START_DATE = to_date(#{startDate},'YYYY-MM-DD')
                                    , END_DATE = to_date(#{endDate},'YYYY-MM-DD'), UPDATE_DATE = sysdate
                                    WHERE VERSION_NO = #{versionNo}
    </update>

    <insert id="insertPAFCVersion" parameterType="com.fanruan.platform.bean.PAFCVersion">
        INSERT INTO PAFC_INPUT_VERSION
        (SUPPLIER_NAME, VERSION_NO, INTERFACE_TOTAL_POINTS,ATTENTION_TOTAL_POINTS,START_DATE,END_DATE,CREATE_DATE)
            VALUES
        (#{supplierName},#{versionNo},#{interfaceTotalPoints},#{attentionTotalPoints},TO_DATE(#{startDate},'YYYY-MM-DD'),TO_DATE(#{endDate},'YYYY-MM-DD'),SYSDATE)
    </insert>

    <insert id="insertPAFCPoints" parameterType="com.fanruan.platform.bean.PAFCPoints">
        INSERT INTO PAFC_INPUT_DISTRIBUTE
            (COMPANY_CODE, VERSION_NO, CREATE_DATE)
        VALUES
            (#{companyCode}, #{versionNo}, SYSDATE)
    </insert>

    <update id="updatePAFCPoints" parameterType="com.fanruan.platform.bean.PAFCPoints">
        UPDATE PAFC_INPUT_DISTRIBUTE SET INTERFACE_DISTRIBUTE_POINTS = #{interfaceDistributePoints}
                                       , ATTENTION_DISTRIBUTE_POINTS = #{attentionDistributePoints}
                                    , UPDATE_DATE = sysdate
        WHERE COMPANY_CODE = #{companyCode} AND VERSION_NO = #{versionNo}
    </update>

    <update id="updatePAFCCompany" parameterType="com.fanruan.platform.bean.PAFCCompany">
        UPDATE PAFC_INPUT_COMPANY SET COMPANY_NAME = #{companyName} WHERE COMPANY_CODE = #{companyCode}
    </update>

    <insert id="insertPAFCCompany" parameterType="com.fanruan.platform.bean.PAFCCompany">
        INSERT INTO PAFC_INPUT_COMPANY (COMPANY_CODE,COMPANY_NAME) VALUES ( #{companyCode}, #{companyName} )
    </insert>

    <delete id="deletePAFCCompany" parameterType="com.fanruan.platform.bean.PAFCCompany">
        DELETE FROM PAFC_INPUT_COMPANY WHERE COMPANY_CODE = #{companyCode}
    </delete>

    <select id="getPAFCVersionList" resultType="com.fanruan.platform.bean.PAFCVersion">
        SELECT A.VERSION_NO,A.SUPPLIER_NAME, A.INTERFACE_TOTAL_POINTS,A.ATTENTION_TOTAL_POINTS, A.START_DATE, A.END_DATE,
               (SELECT SUM(INTERFACE_DISTRIBUTE_POINTS) FROM PAFC_INPUT_DISTRIBUTE WHERE VERSION_NO = A.VERSION_NO) AS INTERFACEDISTRIBUTETOTALPOINTS,
               (SELECT SUM(ATTENTION_DISTRIBUTE_POINTS) FROM PAFC_INPUT_DISTRIBUTE WHERE VERSION_NO = A.VERSION_NO) AS ATTENTIONDISTRIBUTETOTALPOINTS
        FROM (SELECT TMP.*,ROW_NUMBER() OVER(PARTITION BY SUPPLIER_NAME ORDER BY END_DATE DESC) AS RN FROM PAFC_INPUT_VERSION TMP) A
        WHERE RN = 1
    </select>

    <select id="getPAFCVersion" resultType="com.fanruan.platform.bean.PAFCVersion">
        SELECT VERSION_NO,SUPPLIER_NAME, INTERFACE_TOTAL_POINTS, START_DATE, END_DATE
        FROM PAFC_INPUT_VERSION WHERE VERSION_NO = #{versionNo} ORDER BY END_DATE DESC
    </select>

    <select id="getPAFCPointsList" resultType="com.fanruan.platform.bean.PAFCPoints">
        SELECT (SELECT SUPPLIER_NAME FROM PAFC_INPUT_VERSION WHERE VERSION_NO = A.VERSION_NO) AS SUPPLIER_NAME,
               A.*  FROM PAFC_INPUT_DISTRIBUTE A WHERE A.VERSION_NO = #{versionNo} ORDER BY COMPANY_CODE
    </select>

    <select id="getCompanyPoints" resultType="com.fanruan.platform.bean.PAFCPoints">
        select * from table(F_CREDIT_FIRM_INPUT(to_date(#{startDate},'yyyy-mm-dd'),to_date(#{endDate},'yyyy-mm-dd'),#{supplierName}))
    </select>

    <select id="getVersionPointsTYC" resultType="com.fanruan.platform.bean.PAFCVersion">
        select * from table(F_CREDIT_TYC_INPUT(to_date(#{startDate},'yyyy-mm-dd'),to_date(#{endDate},'yyyy-mm-dd')))

    </select>

    <select id="getVersionPointsZCX" resultType="com.fanruan.platform.bean.PAFCVersion">
        select * from table(F_CREDIT_ZCX_INPUT(to_date(#{startDate},'yyyy-mm-dd'),to_date(#{endDate},'yyyy-mm-dd')))
    </select>

    <select id="getPAFCCompanyList" resultType="com.fanruan.platform.bean.PAFCCompany">
        SELECT * FROM PAFC_INPUT_COMPANY ORDER BY COMPANY_CODE
    </select>


    <select id="getPAFCUserList" resultType="com.fanruan.platform.bean.PAFCUser">
        SELECT * FROM PAFC_INPUT_USER
    </select>

    <select id="getPAFCUserListByCompanyCode" parameterType="java.lang.String" resultType="com.fanruan.platform.bean.PAFCUser">
        SELECT * FROM PAFC_INPUT_USER WHERE COMPANY_CODE = #{companyCode}
    </select>

    <select id="getENTTokenId" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT ENT_TOKENID FROM CREDIT_API_RELATION WHERE ENTNAME = #{companyName}
    </select>

    <select id="getCompanyNameByTokenId" parameterType="java.lang.String" resultType="java.lang.String">
        SELECT ENTNAME FROM CREDIT_API_RELATION WHERE ENT_TOKENID = #{tokenId}
    </select>

    <select id="getCompanyName" resultType="com.fanruan.platform.bean.CompanyLevel">
        SELECT CODE,NAME,SCODE FROM(
                                       SELECT CODE,NAME,SHORTNAME,SCODE,SNAME FROM ODS_HR_ORG
                                       WHERE ENABLESTATE = 2
                                       UNION ALL
                                       SELECT CODE,NAME,SHORTNAME,SCODE,SNAME FROM INPUT_HR_ORG
                                       WHERE ENABLESTATE = 1) WHERE CODE =  #{companyCode}
    </select>

    <select id="getLV2Company" resultType="com.fanruan.platform.bean.CompanyLevel">
        WITH DS1 AS(
            SELECT CODE,NAME,SHORTNAME,SCODE,SNAME FROM ODS_HR_ORG
            WHERE ENABLESTATE = 2
            UNION ALL
            SELECT CODE,NAME,SHORTNAME,SCODE,SNAME FROM INPUT_HR_ORG
            WHERE ENABLESTATE = 1)
        SELECT CODE,NAME FROM DS1 WHERE CODE = '010'
        UNION
        SELECT CODE,NAME FROM DS1 WHERE SCODE = '010'
        ORDER BY CODE
    </select>

    <resultMap id="getBlackListDetailListResultMap" type="com.fanruan.platform.bean.BlackListDetailResultList">
        <result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />
        <result column="ORG_NO" jdbcType="VARCHAR" property="orgNo" />
        <result column="JURIDICAL_PERSON_NAME" jdbcType="VARCHAR" property="juridicalPersonName" />
        <result column="ENTERPRISE_STATUS" jdbcType="VARCHAR" property="enterpriseStatus" />
        <result column="INDUSTRY_CATEGORY" jdbcType="VARCHAR" property="industryCategory" />
        <result column="SUBJECT_CATEGORY" jdbcType="VARCHAR" property="subjectCategory" />
        <result column="BUSINESS_CATEGORY" jdbcType="VARCHAR" property="businessCategory" />
        <result column="STATUS" jdbcType="VARCHAR" property="status" />
        <result column="RISK_REASON" jdbcType="VARCHAR" property="riskReason" />
        <result column="BE_RISKY_ASSETS_DATE" jdbcType="VARCHAR" property="beRiskyAssetsDate" />
        <result column="EXISTING_DIFFICULTIES" jdbcType="VARCHAR" property="existingDifficulties" />
        <result column="AMOUNT_OF_MARK" jdbcType="VARCHAR" property="amountOfMark" />
        <result column="DATA_SOURCE" jdbcType="VARCHAR" property="dataSource" />
    </resultMap>
    <select id="getBlackListDetailList" resultType="com.fanruan.platform.bean.BlackListDetailResultList">
        select * from(
            select rownum as rowno, N.* from (
                select * from V_CREDIT_BLACKLIST
                where LIMITS_COMPANYNAME in (
                SELECT DISTINCT O.SUBCOMPANYNAME --二级公司
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  A.CODE=#{userCode}--用户名
                AND O.TP=2
                UNION
                SELECT DISTINCT O.SUBCOMPANYNAME --管理员
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  'admin'=#{userCode}--用户名
                AND O.TP IN (1,2)
                UNION
                SELECT DISTINCT O.SUBCOMPANYNAME --集团
                FROM DIM_ORG O
                WHERE  '浙江省国际贸易集团有限公司' =
                (
                SELECT DISTINCT O.SUBCOMPANYNAME --集团
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  A.CODE=#{userCode}--用户名
                AND O.TP=1
                )
                AND O.TP IN (1,2)
                UNION
                SELECT a.NAME FROM(
                SELECT * FROM biuser.ODS_HR_ORG a start  with a.NAME  = (
                SELECT ORGNAME
                FROM ODS_HR_PSNDOC A
                WHERE  A.CODE=#{userCode}--用户名
                )  connect  by
                prior  a.SCODE  = a.CODE) a
                WHERE SCODE = '010' OR CODE = '010'
                )
                ORDER BY BE_RISKY_ASSETS_DATE DESC
            ) N
            where 1=1
            <if test="companyName != null and companyName!=''">
                and (N.COMPANY_NAME like '%'||#{companyName}||'%' )
            </if>
            <if test="dataSource != null and dataSource != ''">
                and (N.DATA_SOURCE = #{dataSource})
            </if>
            <if test="startDate != null and startDate != ''">
                AND N.BE_RISKY_ASSETS_DATE >= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND N.BE_RISKY_ASSETS_DATE &lt;= #{endDate}
            </if>
        ) M
        WHERE 1 = 1
        <if test=" pageIndex != null and pageIndex != '' and pageSize != null and pageSize != ''">
            AND rowno &lt;= #{pageIndex} * #{pageSize}
            AND rowno &gt; (#{pageIndex}-1) * #{pageSize}
        </if>
    </select>

    <select id="getBlackListDetailListCount" resultType="java.lang.Integer">
        select count(*) from (
            select * from(
                select * from V_CREDIT_BLACKLIST
                where LIMITS_COMPANYNAME in (
                SELECT DISTINCT O.SUBCOMPANYNAME --二级公司
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  A.CODE=#{userCode}--用户名
                AND O.TP=2
                UNION
                SELECT DISTINCT O.SUBCOMPANYNAME --管理员
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  'admin'=#{userCode}--用户名
                AND O.TP IN (1,2)
                UNION
                SELECT DISTINCT O.SUBCOMPANYNAME --集团
                FROM DIM_ORG O
                WHERE  '浙江省国际贸易集团有限公司' =
                (
                SELECT DISTINCT O.SUBCOMPANYNAME --集团
                FROM ODS_HR_PSNDOC A
                LEFT JOIN DIM_ORG O ON A.ORGCODE=O.SUBCOMPANYCODE
                WHERE  A.CODE=#{userCode}--用户名
                AND O.TP=1
                )
                AND O.TP IN (1,2)
                UNION
                SELECT a.NAME FROM(
                SELECT * FROM biuser.ODS_HR_ORG a start  with a.NAME  = (
                SELECT ORGNAME
                FROM ODS_HR_PSNDOC A
                WHERE  A.CODE=#{userCode}--用户名
                )  connect  by
                prior  a.SCODE  = a.CODE) a
                WHERE SCODE = '010' OR CODE = '010'
                )
            ) N
            WHERE 1=1
            <if test="companyName != null and companyName!=''">
                AND (N.COMPANY_NAME like '%'||#{companyName}||'%' )
            </if>
            <if test="dataSource != null and dataSource != ''">
                AND (N.DATA_SOURCE = #{dataSource})
            </if>
            <if test="startDate != null and startDate != ''">
                AND N.BE_RISKY_ASSETS_DATE >= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND N.BE_RISKY_ASSETS_DATE &lt;= #{endDate}
            </if>
        )
    </select>

    <insert id="insertConcernHistory" parameterType="com.fanruan.platform.bean.LogConcernHistory">
        INSERT INTO LOG_CONCERN_HISTORY
        (ENTNAME, CODE, REQUEST_ID, UPDATE_BY, INSERT_DATE, CONCERN_FLAG, OPERATE_FLAG, DATA_SOURCE)
        VALUES
            (#{entName}, #{code}, #{requestId}, #{updateBy}, SYSDATE, #{concernFlag}, #{operateFlag}, #{dataSource})
    </insert>

    <select id="getInterfaceUsedNumber" resultType="java.lang.Integer">
        SELECT
            COUNT(*) AS USED_NUMBER
        FROM ODS_TYC_JSON A
                 LEFT JOIN CREDIT_API_RELATION B
                           ON SUBSTR(A.TOKEN_ID,1,3) = B.ENT_TOKENID
        WHERE TO_CHAR(A.UPDATETIME,'YYYY-MM-DD') = TO_CHAR(SYSDATE,'YYYY-MM-DD')
          AND A.JSONFLAG = #{jsonFlag}
          AND A.ERROR_CODE = '0'
          AND B.ENTNAME  = #{companyName}
        GROUP BY A.JSONFLAG,B.ENTNAME
    </select>

    <select id="getInterfaceLimitNumber" resultType="java.lang.Integer">
        SELECT LIMIT_NUMBER FROM (
            SELECT LIMIT_NUMBER, UPDATE_DATE FROM INTERFACE_USED_LIMIT
            WHERE JSON_FLAG = #{jsonFlag}
              AND COMPANY_NAME = #{companyName}
            ORDER BY UPDATE_DATE DESC
        )A
        WHERE 1=1
          AND ROWNUM = 1
    </select>

    <select id="getValidRequest4TheDay" resultType="com.fanruan.platform.bean.TianYanChaJson">
        SELECT * FROM ODS_TYC_JSON
        WHERE 1=1
          AND ERROR_CODE = '0'
          AND TO_CHAR(UPDATETIME, 'YYYY-MM-DD') = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
          AND NAME = #{companyName}
          AND JSONFLAG = #{jsonFlag}
        ORDER BY UPDATETIME DESC
    </select>

    <select id="getTokenList" resultType="com.fanruan.platform.bean.OpenAPI">
        SELECT * FROM (
            SELECT ROWNUM AS RN, B.* FROM(
                SELECT A.OPEN_ID,
                    CASE WHEN SUBSTR(A.TOKEN_ID,0,2)='0X'
                    THEN (SELECT DISTINCT ENTNAME FROM CREDIT_API_RELATION WHERE ENT_TOKENID = SUBSTR(A.TOKEN_ID,3,3))
                    ELSE (SELECT DISTINCT ENTNAME FROM CREDIT_API_RELATION WHERE ENT_TOKENID = SUBSTR(A.TOKEN_ID,0,3))
                    END AS COMPANY_NAME,
                    A.URI,
                    A.INTERFACE_NAME,
                    A.TOKEN_ID,
                    A.REMARK,
                    CASE WHEN SUBSTR(A.TOKEN_ID,0,2)='0X'
                    THEN 0
                    ELSE 1
                    END AS STATUS
                    FROM CREDIT_OPEN_API A
            ) B
                WHERE 1=1
                <if test="companyName != null and companyName != ''">
                    AND B.COMPANY_NAME = #{companyName}
                </if>
                <if test="uri != null and uri != ''">
                    AND B.URI LIKE '%'||#{uri}||'%'
                </if>
                <if test="interfaceName != null and interfaceName != ''">
                    AND B.INTERFACE_NAME LIKE '%'||#{interfaceName}||'%'
                </if>
                <if test="status != null">
                    and B.STATUS = #{status}
                </if>
        )
        WHERE 1 = 1
        AND RN &lt;= #{pageIndex} * #{pageSize}
        AND RN &gt; (#{pageIndex}-1) * #{pageSize}

    </select>

    <select id="getTokenListTotalCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM
        (
        SELECT ROWNUM AS RN, B.* FROM(
            SELECT A.OPEN_ID,
                CASE WHEN SUBSTR(A.TOKEN_ID,0,2)='0X'
                THEN (SELECT DISTINCT ENTNAME FROM CREDIT_API_RELATION WHERE ENT_TOKENID = SUBSTR(A.TOKEN_ID,3,3))
                ELSE (SELECT DISTINCT ENTNAME FROM CREDIT_API_RELATION WHERE ENT_TOKENID = SUBSTR(A.TOKEN_ID,0,3))
                END AS COMPANY_NAME,
                A.URI,
                A.INTERFACE_NAME,
                A.TOKEN_ID,
                A.REMARK,
                CASE WHEN SUBSTR(A.TOKEN_ID,0,2)='0X'
                THEN 0
                ELSE 1
                END AS STATUS
                FROM CREDIT_OPEN_API A
        ) B
        WHERE 1=1
        <if test="companyName != null and companyName != ''">
            AND B.COMPANY_NAME = #{companyName}
        </if>
        <if test="uri != null and uri != ''">
            AND B.URI LIKE '%'||#{uri}||'%'
        </if>
        <if test="interfaceName != null and interfaceName != ''">
            AND B.INTERFACE_NAME LIKE '%'||#{interfaceName}||'%'
        </if>
        <if test="status != null">
            and B.STATUS = #{status}
        </if>
        )
    </select>

    <update id="updateOpenAPIStatus">
        UPDATE CREDIT_OPEN_API SET TOKEN_ID = #{tokenId} WHERE OPEN_ID = #{openId}
    </update>

    <select id="getOpenAPIRelationList" resultType="com.fanruan.platform.bean.OpenAPIRelation">
        SELECT ENTNAME AS companyName, ENT_TOKENID AS tokenIdPrefix, SHORT_NAME AS companyNameShort, ID AS id
        FROM CREDIT_API_RELATION ORDER BY ENT_TOKENID
    </select>

    <insert id="insertTokenRelation">
        INSERT INTO CREDIT_API_RELATION (ENTNAME, ENT_TOKENID, SHORT_NAME) VALUES (#{companyName}, #{tokenIdPrefix}, #{companyNameShort})
    </insert>

    <update id="updateTokenRelation">
        UPDATE CREDIT_API_RELATION SET ENTNAME = #{companyName}, ENT_TOKENID = #{tokenIdPrefix}, SHORT_NAME = #{companyNameShort}
        WHERE id = #{id, jdbcType=INTEGER}
    </update>

    <delete id="deleteTokenRelation">
        DELETE FROM CREDIT_API_RELATION WHERE id = #{id, jdbcType=INTEGER}
    </delete>

    <delete id="deleteCreditOpenAPI" parameterType="java.lang.String">
        DELETE FROM CREDIT_OPEN_API WHERE TOKEN_ID LIKE #{tokenId}||'%' OR TOKEN_ID LIKE '0X'||#{tokenId}||'%'
    </delete>

    <insert id="insertToken">
        INSERT INTO CREDIT_OPEN_API (TOKEN_ID, TOKEN_KEY, URI, INTERFACE_NAME, REMARK) VALUES (#{tokenId},'credit_service_token',  #{uri}, #{interfaceName}, #{remark})
    </insert>

    <update id="updateToken">
        UPDATE CREDIT_OPEN_API SET TOKEN_ID = #{tokenId}, URI = #{uri}, INTERFACE_NAME = #{interfaceName}, REMARK = #{remark}
        WHERE OPEN_ID = #{openId, jdbcType=INTEGER}
    </update>

    <select id="getInterfaceLimitList" resultType="com.fanruan.platform.bean.InterfaceUsedLimit">
        SELECT * FROM (
            SELECT ROWNUM AS RN, A.* FROM(
                SELECT ID,COMPANY_NAME,INTERFACE_NAME,JSON_FLAG,LIMIT_NUMBER,TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
                 FROM INTERFACE_USED_LIMIT
            ) A
            WHERE 1 = 1
            <if test="companyName != null and companyName != ''">
                AND COMPANY_NAME = #{companyName}
            </if>
            <if test="interfaceName != null and interfaceName != ''">
                AND INTERFACE_NAME LIKE '%'||#{interfaceName}||'%'
            </if>
            <if test="jsonFlag != null and jsonFlag != ''">
                AND JSON_FLAG LIKE '%'||#{jsonFlag}||'%'
            </if>
            ORDER BY COMPANY_NAME, JSON_FLAG
        )
        WHERE 1 = 1
        AND RN &lt;= #{pageIndex} * #{pageSize}
        AND RN &gt; (#{pageIndex}-1) * #{pageSize}
    </select>

    <select id="getInterfaceLimitListTotalCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM (
            SELECT ROWNUM AS RN, A.* FROM(
                SELECT * FROM INTERFACE_USED_LIMIT
            ) A
            WHERE 1 = 1
            <if test="companyName != null and companyName != ''">
                AND COMPANY_NAME = #{companyName}
            </if>
            <if test="interfaceName != null and interfaceName != ''">
                AND INTERFACE_NAME LIKE '%'||#{interfaceName}||'%'
            </if>
            <if test="jsonFlag != null and jsonFlag != ''">
                AND JSON_FLAG LIKE '%'||#{jsonFlag}||'%'
            </if>
        )
    </select>

    <delete id="deleteInterfaceLimit" parameterType="com.fanruan.platform.bean.InterfaceUsedLimit">
        DELETE INTERFACE_USED_LIMIT WHERE ID = #{id}
    </delete>

    <update id="updateInterfaceLimit" parameterType="com.fanruan.platform.bean.InterfaceUsedLimit">
        UPDATE INTERFACE_USED_LIMIT SET LIMIT_NUMBER = #{limitNumber}, UPDATE_DATE = SYSDATE
                                        WHERE ID = #{id}
    </update>

    <insert id="insertInterfaceLimit" parameterType="com.fanruan.platform.bean.InterfaceUsedLimit" >
        INSERT INTO INTERFACE_USED_LIMIT (COMPANY_NAME, INTERFACE_NAME, JSON_FLAG, LIMIT_NUMBER, UPDATE_DATE, INSERT_DATE)
        VALUES
            (#{companyName}, #{interfaceName}, #{jsonFlag}, #{limitNumber}, SYSDATE, SYSDATE)
    </insert>

    <select id="getCreditOpenApi" resultType="com.fanruan.platform.bean.OpenAPI">
        SELECT * FROM CREDIT_OPEN_API
            WHERE 1 = 1
            <if test="tokenId != null and tokenId != ''">
                AND (TOKEN_ID = #{tokenId} OR TOKEN_ID = '0X'||#{tokenId} )
            </if>
            <if test="uri != null and uri != ''">
                AND URI = #{uri}
            </if>
            <if test="openId != null and openId != ''">
                AND OPEN_ID = #{openId}
            </if>
    </select>

    <select id="getCreditApiRelation" parameterType="java.lang.String" resultType="com.fanruan.platform.bean.OpenAPIRelation">
        SELECT ID,ENTNAME AS COMPANY_NAME,ENT_TOKENID AS TOKEN_ID_PREFIX,SHORT_NAME AS COMPANY_NAME_SHORT FROM CREDIT_API_RELATION
        WHERE 1 = 1
        AND ENT_TOKENID = #{tokenIdPrefix}
    </select>

</mapper>

